import f,{createContext,useReducer,useEffect,useContext,useState,useRef}from'react';import {useDisclosure,Modal,ModalContent,ModalHeader,ModalBody,ModalFooter}from'@nextui-org/modal';import {motion,AnimatePresence}from'framer-motion';import {Button}from'@nextui-org/button';import {Tabs,Tab}from'@nextui-org/tabs';import {CalendarDaysIcon,Calendar,ArrowLeft,ArrowRight,TrashIcon}from'lucide-react';import {BsCalendarWeek,BsCalendarMonth}from'react-icons/bs';import {Input,Textarea}from'@nextui-org/input';import {Select,SelectItem}from'@nextui-org/select';import {Dropdown,DropdownTrigger,DropdownMenu,DropdownItem}from'@nextui-org/dropdown';import {parseDate,Time}from'@internationalized/date';import {DateRangePicker}from'@nextui-org/date-picker';import {TimeInput}from'@nextui-org/date-input';import {useForm}from'react-hook-form';import {zodResolver}from'@hookform/resolvers/zod';import {z as z$1}from'zod';import {v4}from'uuid';import {Chip}from'@nextui-org/chip';import {Card}from'@nextui-org/card';import Se from'clsx';var me=createContext(void 0),ue=({children:t})=>{let[o,s]=useState(null),[i,a]=useState(null),{isOpen:m,onOpen:c,onClose:h}=useDisclosure(),p=async({title:M,body:w,footer:S,modalClassName:y,getter:A})=>{if(s({title:M,body:w,footer:S,modalClassName:y}),A)try{let T=await A();a(T);}catch(T){console.error("Error fetching data:",T),a(null);}else a(null);c();};return f.createElement(me.Provider,{value:{showModal:p,onClose:h,data:i}},t,f.createElement(Modal,{backdrop:"blur",classNames:{backdrop:"max-h-screen overflow-hidden",wrapper:"max-h-screen overflow-hidden"},isOpen:m,onOpenChange:h},f.createElement(ModalContent,{className:o?.modalClassName||""},o&&f.createElement(f.Fragment,null,o.title&&f.createElement(ModalHeader,null,o.title),o.body&&f.createElement(ModalBody,null,o.body),o.footer&&f.createElement(ModalFooter,null,o.footer)))))},_=()=>{let t=useContext(me);if(!t)throw new Error("useModalContext must be used within a ModalProvider");return t};var Le=(t,o)=>{switch(o.type){case"ADD_EVENT":return {...t,events:[...t.events,o.payload]};case"REMOVE_EVENT":return {...t,events:t.events.filter(s=>s.id!==o.payload.id)};case"UPDATE_EVENT":return {...t,events:t.events.map(s=>s.id===o.payload.id?o.payload:s)};case"SET_EVENTS":return {...t,events:o.payload};default:return t}},pe=createContext(void 0),Ue=({children:t,onAddEvent:o,onUpdateEvent:s,onDeleteEvent:i,initialState:a,weekStartsOn:m="sunday"})=>{let[c,h]=useReducer(Le,{events:a??[]});useEffect(()=>{a&&h({type:"SET_EVENTS",payload:a});},[a]);let A={getDaysInMonth:(l,D)=>Array.from({length:new Date(D,l+1,0).getDate()},(u,n)=>({day:n+1,events:[]})),getEventsForDay:(l,D)=>c?.events.filter(u=>{let n=new Date(u.startDate),r=new Date(u.endDate),d=new Date(D);d.setDate(l),d.setHours(0,0,0,0);let v=new Date(D);v.setDate(l+1),v.setHours(0,0,0,0);let C=n.getDate()===l&&n.getMonth()===D.getMonth()&&n.getFullYear()===D.getFullYear(),e=n<v&&r>=d;return C||e}),getDaysInWeek:(l,D)=>{let u=m==="sunday"?0:1,n=new Date(D,0,1),r=n.getDay(),d=new Date(n);d.setDate(n.getDate()+(l-1)*7+(u-r+7)%7);let v=[];for(let C=0;C<7;C++){let e=new Date(d);e.setDate(e.getDate()+C),v.push(e);}return v},getWeekNumber:l=>{let D=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate()));D.setUTCDate(D.getUTCDate()+4-(D.getUTCDay()||7));let u=new Date(Date.UTC(D.getUTCFullYear(),0,1));return Math.ceil(((D.getTime()-u.getTime())/864e5+1)/7)},getDayName:l=>["Dom","Seg","Ter","Qua","Qui","Sex","S\xE1b"][l]};function T(l,D){let u=D.filter(e=>e.startDate<l.endDate&&e.endDate>l.startDate),n=u.length||1,r=u.indexOf(l),d=0,v=0,C=0;if(l.startDate instanceof Date&&l.endDate instanceof Date){let e=l.startDate.getHours()*60+l.startDate.getMinutes();d=(l.endDate.getHours()*60+l.endDate.getMinutes()-e)/60*64;let W=l.startDate.getHours()+l.startDate.getMinutes()/60;v=Math.max(0,(24-W)*64),d=Math.min(d,v),C=W*64;}else console.error("Invalid event or missing start/end dates.");return {height:`${d<10?20:d>v?v:d}px`,top:`${C}px`,zIndex:r+1,left:`${r*100/n}%`,maxWidth:`${100/n}%`,minWidth:`${100/n}%`}}function V(l){h({type:"ADD_EVENT",payload:l}),o&&o(l);}function Y(l,D){h({type:"UPDATE_EVENT",payload:{...l,id:D}}),s&&s(l);}function k(l){h({type:"REMOVE_EVENT",payload:{id:l}}),i&&i(l);}let H={handleEventStyling:T,handleAddEvent:V,handleUpdateEvent:Y,handleDeleteEvent:k};return f.createElement(pe.Provider,{value:{events:c,dispatch:h,getters:A,handlers:H,weekStartsOn:m}},f.createElement(ue,null,t))},I=()=>{let t=useContext(pe);if(!t)throw new Error("useScheduler must be used within a SchedulerProvider");return t};function q(t){return `${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function fe(t){let{year:o,month:s,day:i}=t;return new Date(o,s-1,i)}function J({data:t,setValue:o,readOnly:s=!1}){let[i,a]=useState({startDate:t?parseDate(q(t?.startDate)):parseDate("2024-04-06"),endDate:t?parseDate(q(t?.endDate)):parseDate("2024-04-10"),startTime:new Time(t?.startDate?.getHours()||0,t?.startDate?.getMinutes()||0),endTime:new Time(t?.endDate?.getHours()||0,t?.endDate?.getMinutes()||0)});return useEffect(()=>{if(!i)return;let m=fe(i.startDate),c=fe(i.endDate);m.setHours(i?.startTime?.hour||0),m.setMinutes(i?.startTime?.minute||0),c.setHours(i?.endTime?.hour||0),c.setMinutes(i?.endTime?.minute||0),c<m&&c.setHours(m.getHours()+1),o("startDate",m),o("endDate",c);},[i,o]),f.createElement("div",{style:{pointerEvents:s?"none":"auto"}},f.createElement("div",{className:"w-full flex gap-4 max-w-full flex-wrap"},f.createElement(DateRangePicker,{label:"Dura\xE7\xE3o do Evento",isRequired:!0,isReadOnly:s,value:{start:i.startDate,end:i.endDate},className:"w-full",onChange:m=>{let c=m?.start,h=m?.end,p=new Date(c?.year||0,(c?.month||1)-1,c?.day||1),M=new Date(h?.year||0,(h?.month||1)-1,h?.day||1);a({...i,startDate:parseDate(q(p)),endDate:parseDate(q(M))});}}),f.createElement("div",{className:"flex flex-wrap gap-4"},f.createElement(TimeInput,{label:"Hora de In\xEDcio",defaultValue:i?.startTime,isReadOnly:s,onChange:m=>{a({...i,startTime:m||new Time(0,0)});}}),f.createElement(TimeInput,{label:"Hora de T\xE9rmino",defaultValue:i?.endTime,isReadOnly:s,onChange:m=>{a({...i,endTime:m||new Time(0,0)});},isInvalid:i?.startTime&&i?.endTime&&i.endTime.hour*60+i.endTime.minute<=i.startTime.hour*60+i.startTime.minute}))))}var Qt=["success","primary","default","warning","danger"],ge=z$1.object({id:z$1.string().optional(),title:z$1.string().nonempty("Event name is required"),description:z$1.string().optional(),startDate:z$1.date(),endDate:z$1.date(),variant:z$1.enum(["primary","danger","success","warning","default"]),color:z$1.string().nonempty("Color selection is required"),productData:z$1.object({product_id:z$1.string().nonempty("Product ID is required"),product_title:z$1.string().nonempty("Product title is required"),learning_path_title:z$1.string().optional(),module_id:z$1.string().nonempty("Module ID is required"),module_title:z$1.string().nonempty("Module title is required")}).optional()});function z({CustomAddEventModal:t,productData:o,readOnly:s=!0}){let {onClose:i,data:a}=_(),[m,c]=useState(d(a?.variant||"primary")),[h,p]=useState(""),[M,w]=useState(""),[S,y]=useState(""),A=o?.filter(e=>e.product_id===h).map(e=>e.learning_path_title).filter((e,N,B)=>e&&B.indexOf(e)===N),T=o?.filter(e=>e.product_id===h&&(!M||e.learning_path_title===M)).map(e=>({id:e.module_id,title:e.module_title})).filter((e,N,B)=>B.findIndex(W=>W.id===e.id)===N),V=o?.map(e=>({id:e.product_id,title:e.product_title})).filter((e,N,B)=>B.findIndex(W=>W.id===e.id)===N),{handlers:k}=I(),{register:H,handleSubmit:l,reset:D,formState:{errors:u},setValue:n}=useForm({resolver:zodResolver(ge),defaultValues:{id:a?.id??v4(),title:a?.title??"",description:a?.description??"",startDate:a?.startDate??new Date,endDate:a?.endDate??(()=>{let e=new Date;return e.setHours(e.getHours()+1),e})(),variant:a?.variant??"primary",color:a?.color??"blue",productData:a?.productData}});useEffect(()=>{a&&D({id:a.id,title:a.title,description:a.description||"",startDate:a.startDate,endDate:a.endDate,variant:a.variant||"primary",color:a.color||"blue",productData:a.productData});},[a,D]);let r=[{key:"blue",name:"Marrom"},{key:"red",name:"Vermelho"},{key:"green",name:"Verde"},{key:"yellow",name:"Amarelo"}];function d(e){switch(e){case"primary":return "blue";case"danger":return "red";case"success":return "green";case"warning":return "yellow";default:return "blue"}}function v(e){switch(e){case"blue":return "primary";case"red":return "danger";case"green":return "success";case"yellow":return "warning";default:return "default"}}return f.createElement("form",{className:"flex flex-col gap-3 max-h-[80vh] overflow-y-auto pr-2",onSubmit:l(e=>{let N=o?.find(L=>L.product_id===h&&(!M||L.learning_path_title===M)&&L.module_id===S),B=L=>L?.replace(/<[^>]*>/g,""),W={id:a?.id??v4(),title:e.title,startDate:e.startDate,endDate:e.endDate,variant:e.variant,description:B(e.description||""),productData:N?{product_id:N.product_id,product_title:N.product_title,learning_path_title:N.learning_path_title,module_id:N.module_id,module_title:N.module_title}:void 0};a?.id?k.handleUpdateEvent(W,a?.id):k.handleAddEvent(W),i();})},t?t({register:H,errors:u}):f.createElement(f.Fragment,null,s?f.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100",dangerouslySetInnerHTML:{__html:a?.title||""}}):f.createElement(Input,{...H("title"),label:"Nome do Evento",placeholder:"Digite o nome do evento",variant:"flat",isReadOnly:s,isInvalid:!!u.title,errorMessage:u.title?.message}),s?f.createElement("div",{className:"w-full min-h-fit overflow-y-auto p-3 rounded-medium bg-default-100",dangerouslySetInnerHTML:{__html:a?.description||""}}):f.createElement(Textarea,{...H("description"),label:"Descri\xE7\xE3o do Evento",placeholder:"Digite a descri\xE7\xE3o do evento",variant:"flat"}),f.createElement(J,{data:a,setValue:n,readOnly:s}),o&&o.length>0&&f.createElement("div",{className:"flex flex-col gap-3"},s?f.createElement("div",{className:"flex flex-col gap-1"},f.createElement("span",{className:"text-sm text-default-700"},"Conte\xFAdo"),f.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},V?.find(e=>e.id===h)?.title||"")):f.createElement(Select,{label:"Conte\xFAdo",placeholder:"Selecione um conte\xFAdo",value:h,variant:"flat",onChange:e=>{p(e.target.value),w(""),y("");}},(V||[]).map(e=>f.createElement(SelectItem,{key:e.id,value:e.id},e.title))),A&&A.length>0&&(s?f.createElement("div",{className:"flex flex-col gap-1"},f.createElement("span",{className:"text-sm text-default-700"},"Trilha"),f.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},M||"")):f.createElement(Select,{label:"Trilha",placeholder:"Selecione uma trilha (opcional)",value:M,variant:"flat",onChange:e=>{w(e.target.value),y("");}},A.map(e=>f.createElement(SelectItem,{key:e,value:e},e)))),T&&T.length>0&&(s?f.createElement("div",{className:"flex flex-col gap-1"},f.createElement("span",{className:"text-sm text-default-700"},"M\xF3dulo"),f.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},T.find(e=>e.id===S)?.title||"")):f.createElement(Select,{label:"M\xF3dulo",placeholder:"Selecione um m\xF3dulo",value:S,variant:"flat",onChange:e=>y(e.target.value)},T.map(e=>f.createElement(SelectItem,{key:e.id,value:e.id},e.title))))),!s&&f.createElement(Dropdown,{backdrop:"blur"},f.createElement(DropdownTrigger,null,f.createElement(Button,{variant:"flat",className:"justify-between w-fit my-4",color:v(m)},r.find(e=>e.key===m)?.name)),f.createElement(DropdownMenu,{"aria-label":"Color selection",variant:"flat",selectionMode:"single",selectedKeys:[m],onSelectionChange:e=>{let N=e.currentKey||"blue";c(N),D(B=>({...B,variant:v(N)}));}},r.map(e=>f.createElement(DropdownItem,{key:e.key,startContent:f.createElement("div",{className:`w-4 h-4 rounded-full bg-${e.key}-500`})},e.name)))),s&&f.createElement(ModalFooter,{className:"px-0"},f.createElement(Button,{color:"primary",variant:"flat",onPress:i},"Fechar")),!s&&f.createElement(ModalFooter,{className:"px-0"},f.createElement(Button,{color:"danger",variant:"light",onPress:i},"Cancelar"),f.createElement(Button,{color:"primary",type:"submit"},"Salvar Evento"))))}var xe=t=>t.toLocaleString("pt-BR",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0});function $({event:t,CustomEventModal:o}){let{showModal:s}=_(),{handlers:i}=I();function a(c){s({title:c?.title,body:f.createElement(z,{CustomAddEventModal:o?.CustomAddEventModal?.CustomForm,productData:o?.CustomAddEventModal?.ProductData}),getter:async()=>({...c})});}let m=c=>c?.replace(/<[^>]*>/g,"");return f.createElement(motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2,ease:"easeInOut"},key:t?.id,className:"w-full relative use-automation-zoom-in cursor-pointer border border-default-400/60 rounded-lg  flex flex-col flex-grow "},f.createElement(Chip,{onClickCapture:c=>{c.stopPropagation(),i.handleDeleteEvent(t?.id);},color:"danger",variant:"solid",classNames:{content:"max-w-fit min-w-0 p-1"},className:"absolute z-50 right-0 top-[-5px]"},f.createElement(TrashIcon,{size:12})),t.CustomEventComponent?f.createElement("div",{onClickCapture:c=>{c.stopPropagation(),a({id:t?.id,title:t?.title,startDate:t?.startDate,endDate:t?.endDate,description:t?.description,variant:t?.variant});}},f.createElement(t.CustomEventComponent,{...t})):f.createElement(Chip,{onClickCapture:c=>{c.stopPropagation(),a({id:t?.id,title:t?.title,startDate:t?.startDate,endDate:t?.endDate,description:t?.description,variant:t?.variant});},variant:"flat",color:t?.variant,classNames:{content:"p-0"},className:`min-w-full items-start p-0 flex-grow flex-col flex ${t?.minmized?"h-full":"min-h-fit p-1"} rounded-md`},f.createElement("div",{className:`flex ${t?.minmized?"p-0":"p-1"} flex-col flex-grow px-1 rounded-md  items-start w-full`},f.createElement("h1",{className:`${t?.minmized&&"text-[0.7rem] p-0 px-1"} font-semibold line-clamp-1 break-words whitespace-pre-wrap`},m(t?.title)),f.createElement("p",{className:"text-[0.65rem] break-words whitespace-pre-wrap line-clamp-3"},m(t?.description||"")),!t?.minmized&&f.createElement("div",{className:"flex justify-between w-full"},f.createElement("p",{className:"text-sm"},xe(t?.startDate)),f.createElement("p",{className:"text-sm"},"-"),f.createElement("p",{className:"text-sm"},xe(t?.endDate))))))}var dt=Array.from({length:24},(t,o)=>`${o.toString().padStart(2,"0")}:00`),mt={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},ut={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3}}};function ee({prevButton:t,nextButton:o,CustomEventComponent:s,CustomEventModal:i,classNames:a}){let m=useRef(null),[c,h]=useState(null),[p,M]=useState(0),[w,S]=useState(new Date),{showModal:y}=_(),{getters:A,handlers:T}=I(),V=n=>{if(!m.current)return;let r=m.current.getBoundingClientRect(),d=n.clientY-r.top,v=r.height/24,C=Math.max(0,Math.min(23,Math.floor(d/v))),e=d%v/v,N=Math.floor(e*60);h(`${C.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`),M(d);},Y=()=>w.toLocaleDateString("pt-BR",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),k=A.getEventsForDay(w?.getDate()||0,w);function H(n){y({title:i?.CustomAddEventModal?.title||"Adicionar Evento",body:f.createElement(z,{CustomAddEventModal:i?.CustomAddEventModal?.CustomForm,productData:i?.CustomAddEventModal?.ProductData}),getter:async()=>{let r=n?.startDate||new Date,d=n?.endDate||new Date;return {startDate:r,endDate:d}}});}function l(n){if(!n){console.error("Detailed hour not provided.");return}let[r,d]=n.split(":").map(Number),v=w.getDate();if(v<1||v>31){console.error("Invalid day selected:",v);return}let C=new Date(w.getFullYear(),w.getMonth(),v,r,d);H({startDate:C,endDate:new Date(C.getTime()+60*60*1e3),title:"",id:"",variant:"primary"});}let D=()=>{let n=new Date(w);n.setDate(w.getDate()+1),S(n);},u=()=>{let n=new Date(w);n.setDate(w.getDate()-1),S(n);};return f.createElement("div",{className:""},f.createElement("div",{className:"flex justify-between gap-3 flex-wrap mb-5"},f.createElement("h1",{className:"text-3xl font-semibold mb-4"},Y()),f.createElement("div",{className:"flex ml-auto  gap-3"},t?f.createElement("div",{onClick:u},t):f.createElement(Button,{className:a?.prev,startContent:f.createElement(ArrowLeft,null),onClick:u},"Anterior"),o?f.createElement("div",{onClick:D},o):f.createElement(Button,{className:a?.next,onClick:D,endContent:f.createElement(ArrowRight,null)},"Pr\xF3ximo"))),f.createElement("div",{className:"flex flex-col gap-4"},f.createElement("div",{className:"all-day-events"},f.createElement(AnimatePresence,{mode:"wait"},k&&k?.length?k?.map((n,r)=>f.createElement("div",{key:`event-${n.id}-${r}`,className:"mb-2"},f.createElement($,{event:{...n,CustomEventComponent:s,minmized:!1},CustomEventModal:i}))):"Nenhum evento para hoje")),f.createElement("div",{className:"relative rounded-md bg-default-50 hover:bg-default-100 transition duration-400"},f.createElement(motion.div,{className:"relative rounded-xl flex ease-in-out",ref:m,variants:mt,initial:"hidden",animate:"visible",onMouseMove:V,onMouseLeave:()=>h(null)},f.createElement("div",{className:"flex  flex-col"},dt.map((n,r)=>f.createElement(motion.div,{key:`hour-${r}`,variants:ut,className:"cursor-pointer   transition duration-300  p-4 h-[64px] text-left text-sm text-muted-foreground border-default-200"},n))),f.createElement("div",{className:"flex relative flex-grow flex-col "},Array.from({length:24}).map((n,r)=>f.createElement("div",{onClick:()=>{l(c);},key:`hour-${r}`,className:"cursor-pointer w-full relative border-b  hover:bg-default-200/50  transition duration-300  p-4 h-[64px] text-left text-sm text-muted-foreground border-default-200"},f.createElement("div",{className:"absolute bg-default-200 flex items-center justify-center text-xs opacity-0 transition left-0 top-0 duration-250 hover:opacity-100 w-full h-full"},"Adicionar Evento"))),f.createElement(AnimatePresence,{mode:"wait"},k&&k?.length?k?.map((n,r)=>{let{height:d,left:v,maxWidth:C,minWidth:e,top:N,zIndex:B}=T.handleEventStyling(n,k);return f.createElement("div",{key:`event-${n.id}-${r}`,style:{minHeight:d,top:N,left:v,maxWidth:C,minWidth:e},className:"flex transition-all duration-1000 flex-grow flex-col z-50 absolute"},f.createElement($,{event:{...n,CustomEventComponent:s,minmized:!0},CustomEventModal:i}))}):""))),c&&f.createElement("div",{className:"absolute left-[50px] w-[calc(100%-53px)] h-[3px]  bg-primary-300 dark:bg-primary/30 rounded-full pointer-events-none",style:{top:`${p}px`}},f.createElement(Chip,{color:"success",variant:"flat",className:"absolute vertical-abs-center z-50 left-[-55px] text-xs uppercase"},c)))))}function te(){let{data:t}=_(),o=t?.dayEvents||[];return f.createElement("div",{className:"flex flex-col gap-2"},o.map(s=>f.createElement($,{key:s.id,event:{...s}})))}function oe({prevButton:t,nextButton:o,CustomEventComponent:s,CustomEventModal:i,classNames:a}){let{getters:m,weekStartsOn:c}=I(),{showModal:h}=_(),[p,M]=useState(new Date),w=m.getDaysInMonth(p.getMonth(),p.getFullYear()),S=()=>{let n=new Date(p.getFullYear(),p.getMonth()-1,1);M(n);},y=()=>{let n=new Date(p.getFullYear(),p.getMonth()+1,1);M(n);};function A(n){h({title:"Adicionar Evento",body:f.createElement(z,null),getter:async()=>{let r=new Date(p.getFullYear(),p.getMonth(),n??1,0,0,0,0),d=new Date(p.getFullYear(),p.getMonth(),n??1,23,59,59,999);return {startDate:r,endDate:d}}});}function T(n){h({title:n?.[0]?.startDate.toLocaleDateString("pt-BR",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),body:f.createElement(te,null),getter:async()=>({dayEvents:n})});}let V={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.02}}},Y={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3}}},k=c==="monday"?["Seg","Ter","Qua","Qui","Sex","S\xE1b","Dom"]:["Dom","Seg","Ter","Qua","Qui","Sex","S\xE1b"],l=(new Date(p.getFullYear(),p.getMonth(),1).getDay()-(c==="monday"?1:0)+7)%7,D=new Date(p.getFullYear(),p.getMonth()-1,1),u=new Date(D.getFullYear(),D.getMonth()+1,0).getDate();return f.createElement("div",null,f.createElement("div",{className:"flex flex-col mb-4"},f.createElement(motion.h2,{key:p.getMonth(),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},className:"text-lg my-5 tracking-tighter font-bold"},p.toLocaleString("default",{month:"long"})," ",p.getFullYear()),f.createElement("div",{className:"flex gap-3"},t?f.createElement("div",{onClick:S},t):f.createElement(Button,{className:a?.prev,startContent:f.createElement(ArrowLeft,null),onClick:S},"Anterior"),o?f.createElement("div",{onClick:y},o):f.createElement(Button,{className:a?.next,onClick:y,endContent:f.createElement(ArrowRight,null)},"Pr\xF3ximo"))),f.createElement(AnimatePresence,{mode:"wait"},f.createElement(motion.div,{variants:V,initial:"hidden",animate:"visible",key:p.getMonth(),className:"grid grid-cols-7 gap-1 sm:gap-2"},k.map((n,r)=>f.createElement("div",{key:r,className:"text-left my-8 text-2xl tracking-tighter font-medium"},n)),Array.from({length:l}).map((n,r)=>f.createElement("div",{key:`offset-${r}`,className:"h-[150px] opacity-50"},f.createElement("div",{className:Se("font-semibold relative text-lg mb-1")},u-l+r+1))),w.map(n=>{let r=m.getEventsForDay(n.day,p);return f.createElement(motion.div,{className:"hover:z-50 border-none h-[150px] rounded group flex flex-col",key:n.day,variants:Y},f.createElement(Card,{isPressable:!0,className:"shadow-md  relative flex p-4 border border-default-100 h-full",onClick:()=>A(n.day)},f.createElement("div",{className:Se("font-semibold relative text-lg mb-1",r.length>0?"text-primary-600":"text-muted-foreground",new Date().getDate()===n.day&&new Date().getMonth()===p.getMonth()&&new Date().getFullYear()===p.getFullYear()?"text-secondary-500":"")},n.day),f.createElement("div",{className:"flex-grow flex flex-col gap-2 w-full overflow-hidden"},f.createElement(AnimatePresence,{mode:"wait"},r?.length>0&&f.createElement($,{event:{...r[0],CustomEventComponent:s,minmized:!0},CustomEventModal:i})),r.length>1&&f.createElement(Chip,{onClick:d=>{d.stopPropagation(),T(r);},variant:"flat",className:"hover:bg-default-200 absolute right-2 text-xs top-2 transition duration-300"},r.length>1?`+${r.length-1}`:" ")),r.length===0&&f.createElement("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300"},f.createElement("span",{className:"text-white tracking-tighter text-lg font-semibold"},"Adicionar Evento"))))}))))}var Ct=Array.from({length:24},(t,o)=>`${o.toString().padStart(2,"0")}:00`);var Mt={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}};function re({prevButton:t,nextButton:o,CustomEventComponent:s,CustomEventModal:i,classNames:a}){let{getters:m,handlers:c}=I(),h=useRef(null),[p,M]=useState(null),[w,S]=useState(0),[y,A]=useState(new Date),{showModal:T}=_(),V=m?.getDaysInWeek(m?.getWeekNumber(y),y.getFullYear()),Y=u=>{if(!h.current)return;let n=h.current.getBoundingClientRect(),r=u.clientY-n.top,d=n.height/24,v=Math.max(0,Math.min(23,Math.floor(r/d))),C=r%d/d,e=Math.floor(C*60);M(`${v.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`),S(r+83);};function k(u){T({title:"Adicionar Evento",body:f.createElement(z,null),getter:async()=>{let n=u?.startDate||new Date,r=u?.endDate||new Date;return {startDate:n,endDate:r}}});}let H=()=>{let u=new Date(y);u.setDate(y.getDate()+7),A(u);},l=()=>{let u=new Date(y);u.setDate(y.getDate()-7),A(u);};function D(u,n){if(!n){console.error("Detailed hour not provided.");return}let[r,d]=n.split(":").map(Number),v=V[u%7].getDate();if(v<1||v>31){console.error("Invalid day selected:",v);return}let C=new Date(y.getFullYear(),y.getMonth(),v,r,d);k({startDate:C,endDate:new Date(C.getTime()+60*60*1e3),title:"",id:"",variant:"primary"});}return f.createElement("div",{className:"flex flex-col gap-4"},f.createElement(motion.div,{key:y.toDateString()+"parent",className:"all-week-events flex flex-col gap-2",variants:Mt,initial:"hidden",animate:"visible"}),f.createElement("div",{className:"flex ml-auto gap-3"},t?f.createElement("div",{onClick:l},t):f.createElement(Button,{className:a?.prev,startContent:f.createElement(ArrowLeft,null),onClick:l},"Anterior"),o?f.createElement("div",{onClick:H},o):f.createElement(Button,{className:a?.next,onClick:H,endContent:f.createElement(ArrowRight,null)},"Pr\xF3ximo")),f.createElement("div",{key:y.toDateString(),className:"grid use-automation-zoom-in grid-cols-8 gap-0"},f.createElement("div",{className:"sticky top-0 left-0 z-30 bg-default-100 rounded-tl-lg h-full border-0  flex items-center justify-center"},f.createElement("span",{className:"text-lg font-semibold text-muted-foreground px-4"},"Semana ",m.getWeekNumber(y))),f.createElement("div",{className:"col-span-7 flex flex-col relative"},f.createElement("div",{className:"grid grid-cols-7 gap-0 flex-grow"},V.map((u,n)=>f.createElement("div",{key:n,className:"relative flex flex-col"},f.createElement("div",{className:"sticky bg-default-100 top-0 z-20 flex-grow flex items-center justify-center"},f.createElement("div",{className:"text-center p-4"},f.createElement("div",{className:"text-lg font-semibold"},m.getDayName(u.getDay())),f.createElement("div",{className:Se("text-lg font-semibold",new Date().getDate()===u.getDate()&&new Date().getMonth()===y.getMonth()&&new Date().getFullYear()===y.getFullYear()?"text-secondary-500":"")},u.getDate()))),f.createElement("div",{className:"absolute top-12 right-0 w-px h-[calc(100%-3rem)]"})))),p&&f.createElement("div",{className:"absolute flex z-10 left-0 w-full h-[3px] bg-primary-300 dark:bg-primary/30 rounded-full pointer-events-none",style:{top:`${w}px`}},f.createElement(Chip,{color:"success",variant:"flat",className:"absolute vertical-abs-center z-50 left-[-55px] text-xs uppercase"},p))),f.createElement("div",{ref:h,onMouseMove:Y,onMouseLeave:()=>M(null),className:"relative grid grid-cols-8 col-span-8"},f.createElement("div",{className:"col-span-1 bg-default-50 hover:bg-default-100 transition duration-400"},Ct.map((u,n)=>f.createElement("div",{key:`hour-${n}`,className:"cursor-pointer border-b border-default-200 p-[16px] h-[64px] text-center text-sm text-muted-foreground border-r"},u))),f.createElement("div",{className:"col-span-7 bg-default-50 grid h-full grid-cols-7"},Array.from({length:7},(u,n)=>{let r=m.getEventsForDay(V[n%7].getDate(),y);return f.createElement("div",{key:`day-${n}`,className:"col-span-1  border-default-200 z-20 relative transition duration-300 cursor-pointer border-r border-b text-center text-sm text-muted-foreground",onClick:()=>{D(n,p);}},f.createElement(AnimatePresence,{mode:"wait"},r?.map((d,v)=>{let{height:C,left:e,maxWidth:N,minWidth:B,top:W,zIndex:L}=c.handleEventStyling(d,r);return f.createElement("div",{key:`event-${d.id}-${v}`,style:{minHeight:C,height:C,top:W,left:e,maxWidth:N,minWidth:B},className:"flex transitio transition-all duration-1000 flex-grow flex-col z-50 absolute"},f.createElement($,{event:{...d,CustomEventComponent:s,minmized:!0},CustomEventModal:i}))})),Array.from({length:24},(d,v)=>f.createElement("div",{key:`day-${n}-hour-${v}`,className:"col-span-1 border-default-200 h-16 z-20 relative transition duration-300 cursor-pointer border-r border-b text-center text-sm text-muted-foreground"},f.createElement("div",{className:"absolute bg-default-100 flex items-center justify-center text-xs opacity-0 transition duration-250 hover:opacity-100 w-full h-full"},"Adicionar Evento"))))})))))}var le={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,type:"spring",stiffness:250}};function Ae({views:t={views:["day","week","month"],mobileViews:["day"]},CustomComponents:o,classNames:s}){let{showModal:i}=_(),[a,m]=f.useState(!1);useEffect(()=>{m(!0);},[]);let[c,h]=f.useState(a?window.innerWidth<=768:!1);useEffect(()=>{if(!a)return;h(window.innerWidth<=768);function w(){window&&window.innerWidth<=768?h(!0):h(!1);}return window&&window.addEventListener("resize",w),()=>window&&window.removeEventListener("resize",w)},[a]);function p(w){i({title:o?.CustomEventModal?.CustomAddEventModal?.title||"Adicionar Evento",body:f.createElement(z,{CustomAddEventModal:o?.CustomEventModal?.CustomAddEventModal?.CustomForm,productData:o?.CustomEventModal?.CustomAddEventModal?.ProductData}),getter:async()=>{let S=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate(),0,0,0,0),y=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate(),23,59,59,999);return {startDate:S,endDate:y}}});}let M=c?t?.mobileViews:t?.views;return f.createElement("div",{className:"flex w-full flex-col"},f.createElement("div",{className:"flex w-full"},f.createElement("div",{className:"dayly-weekly-monthly-selection relative w-full"},f.createElement(Tabs,{classNames:{...s?.tabs},"aria-label":"Options",color:"primary",variant:"solid"},M?.includes("day")&&f.createElement(Tab,{key:"day",title:o?.customTabs?.CustomDayTab?o.customTabs.CustomDayTab:f.createElement("div",{className:"flex items-center space-x-2"},f.createElement(CalendarDaysIcon,{size:15}),f.createElement("span",null,"Dia"))},f.createElement(motion.div,{...le},f.createElement(ee,{classNames:s?.buttons,prevButton:o?.customButtons?.CustomPrevButton,nextButton:o?.customButtons?.CustomNextButton,CustomEventComponent:o?.CustomEventComponent,CustomEventModal:o?.CustomEventModal}))),M?.includes("week")&&f.createElement(Tab,{key:"week",title:o?.customTabs?.CustomWeekTab?o.customTabs.CustomWeekTab:f.createElement("div",{className:"flex items-center space-x-2"},f.createElement(BsCalendarWeek,null),f.createElement("span",null,"Semana"))},f.createElement(motion.div,{...le},f.createElement(re,{classNames:s?.buttons,prevButton:o?.customButtons?.CustomPrevButton,nextButton:o?.customButtons?.CustomNextButton,CustomEventComponent:o?.CustomEventComponent,CustomEventModal:o?.CustomEventModal}))),M?.includes("month")&&f.createElement(Tab,{key:"month",title:o?.customTabs?.CustomMonthTab?o.customTabs.CustomMonthTab:f.createElement("div",{className:"flex items-center space-x-2"},f.createElement(BsCalendarMonth,null),f.createElement("span",null,"M\xEAs"))},f.createElement(motion.div,{...le},f.createElement(oe,{classNames:s?.buttons,prevButton:o?.customButtons?.CustomPrevButton,nextButton:o?.customButtons?.CustomNextButton,CustomEventComponent:o?.CustomEventComponent,CustomEventModal:o?.CustomEventModal})))),o?.customButtons?.CustomAddEventButton?f.createElement("div",{onClick:()=>p(),className:"absolute top-0 right-0"},o?.customButtons.CustomAddEventButton):f.createElement(Button,{onClick:()=>p(),className:"absolute top-0 right-0 "+s?.buttons?.addEvent,color:"primary",startContent:f.createElement(Calendar,null)},"Adicionar Evento"))))}export{Ae as SchedularView,Ue as SchedulerProvider,ge as eventSchema,I as useScheduler,Qt as variants};