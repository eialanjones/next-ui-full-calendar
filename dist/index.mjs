import u,{createContext,useReducer,useEffect,useContext,useState,useRef}from'react';import {useDisclosure,Modal,ModalContent,ModalHeader,ModalBody,ModalFooter}from'@nextui-org/modal';import {motion,AnimatePresence}from'framer-motion';import {Button}from'@nextui-org/button';import {Tabs,Tab}from'@nextui-org/tabs';import {CalendarDaysIcon,Calendar,ArrowLeft,ArrowRight,TrashIcon}from'lucide-react';import {BsCalendarWeek,BsCalendarMonth}from'react-icons/bs';import {Input,Textarea}from'@nextui-org/input';import {Select,SelectItem}from'@nextui-org/select';import {Dropdown,DropdownTrigger,DropdownMenu,DropdownItem}from'@nextui-org/dropdown';import {parseDate,Time}from'@internationalized/date';import {DateRangePicker}from'@nextui-org/date-picker';import {TimeInput}from'@nextui-org/date-input';import {useForm}from'react-hook-form';import {zodResolver}from'@hookform/resolvers/zod';import {z as z$1}from'zod';import {v4}from'uuid';import {Chip}from'@nextui-org/chip';import {Card}from'@nextui-org/card';import ke from'clsx';var ce=createContext(void 0),pe=({children:e})=>{let[n,c]=useState(null),[i,r]=useState(null),{isOpen:v,onOpen:s,onClose:h}=useDisclosure(),m=async({title:C,body:b,footer:M,modalClassName:E,getter:P})=>{if(c({title:C,body:b,footer:M,modalClassName:E}),P)try{let A=await P();r(A);}catch(A){console.error("Error fetching data:",A),r(null);}else r(null);s();};return u.createElement(ce.Provider,{value:{showModal:m,onClose:h,data:i}},e,u.createElement(Modal,{backdrop:"blur",classNames:{backdrop:"max-h-screen overflow-hidden",wrapper:"max-h-screen overflow-hidden"},isOpen:v,onOpenChange:h},u.createElement(ModalContent,{className:n?.modalClassName||""},n&&u.createElement(u.Fragment,null,n.title&&u.createElement(ModalHeader,null,n.title),n.body&&u.createElement(ModalBody,null,n.body),n.footer&&u.createElement(ModalFooter,null,n.footer)))))},F=()=>{let e=useContext(ce);if(!e)throw new Error("useModalContext must be used within a ModalProvider");return e};var je=(e,n)=>{switch(n.type){case"ADD_EVENT":return {...e,events:[...e.events,n.payload]};case"REMOVE_EVENT":return {...e,events:e.events.filter(c=>c.id!==n.payload.id)};case"UPDATE_EVENT":return {...e,events:e.events.map(c=>c.id===n.payload.id?n.payload:c)};case"SET_EVENTS":return {...e,events:n.payload};default:return e}},ge=createContext(void 0),Ge=({children:e,onAddEvent:n,onUpdateEvent:c,onDeleteEvent:i,initialState:r,weekStartsOn:v="sunday",canEdit:s=h=>!0})=>{let[h,m]=useReducer(je,{events:r??[]});useEffect(()=>{r&&m({type:"SET_EVENTS",payload:r});},[r]);let A={getDaysInMonth:(l,d)=>Array.from({length:new Date(d,l+1,0).getDate()},(t,a)=>({day:a+1,events:[]})),getEventsForDay:(l,d)=>h?.events.filter(t=>{let a=new Date(t.startDate),g=new Date(t.endDate),p=new Date(d);p.setDate(l),p.setHours(0,0,0,0);let y=new Date(d);y.setDate(l+1),y.setHours(0,0,0,0);let N=a.getDate()===l&&a.getMonth()===d.getMonth()&&a.getFullYear()===d.getFullYear(),k=a<y&&g>=p;return N||k}),getDaysInWeek:(l,d)=>{let t=v==="sunday"?0:1,a=new Date(d,0,1),g=a.getDay(),p=new Date(a);p.setDate(a.getDate()+(l-1)*7+(t-g+7)%7);let y=[];for(let N=0;N<7;N++){let k=new Date(p);k.setDate(k.getDate()+N),y.push(k);}return y},getWeekNumber:l=>{let d=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate()));d.setUTCDate(d.getUTCDate()+4-(d.getUTCDay()||7));let t=new Date(Date.UTC(d.getUTCFullYear(),0,1));return Math.ceil(((d.getTime()-t.getTime())/864e5+1)/7)},getDayName:l=>["Dom","Seg","Ter","Qua","Qui","Sex","S\xE1b"][l]};function V(l,d){let t=d.filter(k=>k.startDate<l.endDate&&k.endDate>l.startDate),a=t.length||1,g=t.indexOf(l),p=0,y=0,N=0;if(l.startDate instanceof Date&&l.endDate instanceof Date){let k=l.startDate.getHours()*60+l.startDate.getMinutes();p=(l.endDate.getHours()*60+l.endDate.getMinutes()-k)/60*64;let I=l.startDate.getHours()+l.startDate.getMinutes()/60;y=Math.max(0,(24-I)*64),p=Math.min(p,y),N=I*64;}else console.error("Invalid event or missing start/end dates.");return {height:`${p<10?20:p>y?y:p}px`,top:`${N}px`,zIndex:g+1,left:`${g*100/a}%`,maxWidth:`${100/a}%`,minWidth:`${100/a}%`}}function H(l){m({type:"ADD_EVENT",payload:l}),n&&n(l);}function S(l,d){m({type:"UPDATE_EVENT",payload:{...l,id:d}}),c&&c(l);}function Y(l){m({type:"REMOVE_EVENT",payload:{id:l}}),i&&i(l);}let W={handleEventStyling:V,handleAddEvent:H,handleUpdateEvent:S,handleDeleteEvent:Y};return u.createElement(ge.Provider,{value:{events:h,dispatch:m,getters:A,handlers:W,weekStartsOn:v,canEdit:s}},u.createElement(pe,null,e))},z=()=>{let e=useContext(ge);if(!e)throw new Error("useScheduler must be used within a SchedulerProvider");return e};function K(e){return `${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function he(e){let{year:n,month:c,day:i}=e;return new Date(n,c-1,i)}function ee({data:e,setValue:n,readOnly:c=!1}){let[i,r]=useState({startDate:e?parseDate(K(e?.startDate)):parseDate("2024-04-06"),endDate:e?parseDate(K(e?.endDate)):parseDate("2024-04-10"),startTime:new Time(e?.startDate?.getHours()||0,e?.startDate?.getMinutes()||0),endTime:new Time(e?.endDate?.getHours()||0,e?.endDate?.getMinutes()||0)});return useEffect(()=>{if(!i)return;let v=he(i.startDate),s=he(i.endDate);v.setHours(i?.startTime?.hour||0),v.setMinutes(i?.startTime?.minute||0),s.setHours(i?.endTime?.hour||0),s.setMinutes(i?.endTime?.minute||0),s<v&&s.setHours(v.getHours()+1),n("startDate",v),n("endDate",s);},[i,n]),u.createElement("div",{style:{pointerEvents:c?"none":"auto"}},u.createElement("div",{className:"w-full flex gap-4 max-w-full flex-wrap"},u.createElement(DateRangePicker,{label:"Dura\xE7\xE3o do Evento",isRequired:!0,isReadOnly:c,value:{start:i.startDate,end:i.endDate},className:"w-full",onChange:v=>{let s=v?.start,h=v?.end,m=new Date(s?.year||0,(s?.month||1)-1,s?.day||1),C=new Date(h?.year||0,(h?.month||1)-1,h?.day||1);r({...i,startDate:parseDate(K(m)),endDate:parseDate(K(C))});}}),u.createElement("div",{className:"flex flex-wrap gap-4 flex-row flex-grow"},u.createElement(TimeInput,{label:"Hora de In\xEDcio",defaultValue:i?.startTime,isReadOnly:c,className:"flex-1",onChange:v=>{r({...i,startTime:v||new Time(0,0)});}}),u.createElement(TimeInput,{label:"Hora de T\xE9rmino",defaultValue:i?.endTime,isReadOnly:c,className:"flex-1",onChange:v=>{r({...i,endTime:v||new Time(0,0)});},isInvalid:i?.startTime&&i?.endTime&&i.endTime.hour*60+i.endTime.minute<=i.startTime.hour*60+i.startTime.minute}))))}var Jt=["success","primary","default","warning","danger"],ye=z$1.object({id:z$1.string().optional(),title:z$1.string().nonempty("Event name is required"),description:z$1.string().optional(),startDate:z$1.date(),endDate:z$1.date(),variant:z$1.enum(["primary","danger","success","warning","default"]),color:z$1.string().nonempty("Color selection is required"),event_type:z$1.string().optional(),productData:z$1.object({product_id:z$1.string().nonempty("Product ID is required"),product_title:z$1.string().nonempty("Product title is required"),learning_path_title:z$1.string().optional(),module_id:z$1.string().nonempty("Module ID is required"),module_title:z$1.string().nonempty("Module title is required")}).optional()});function $({CustomAddEventModal:e,productData:n,eventTypes:c}){let {onClose:i,data:r}=F(),{canEdit:v}=z(),s=!!r?.id&&!v(r?.id||""),[h,m]=useState(y(r?.variant||"primary")),[C,b]=useState(""),[M,E]=useState(""),[P,A]=useState(""),V=n?.filter(o=>o.product_id===C).map(o=>o.learning_path_title).filter((o,T,I)=>o&&I.indexOf(o)===T),H=n?.filter(o=>o.product_id===C&&(!M||o.learning_path_title===M)).map(o=>({id:o.module_id,title:o.module_title})).filter((o,T,I)=>I.findIndex(U=>U.id===o.id)===T),S=n?.map(o=>({id:o.product_id,title:o.product_title})).filter((o,T,I)=>I.findIndex(U=>U.id===o.id)===T),{handlers:W}=z(),{register:l,handleSubmit:d,reset:t,formState:{errors:a},setValue:g}=useForm({resolver:zodResolver(ye),defaultValues:{id:r?.id??v4(),title:r?.title??"",description:r?.description??"",startDate:r?.startDate??new Date,endDate:r?.endDate??(()=>{let o=new Date;return o.setHours(o.getHours()+1),o})(),variant:r?.variant??"primary",color:r?.color??"blue",productData:r?.productData,event_type:r?.event_type??""}});useEffect(()=>{r&&t({id:r.id,title:r.title,description:r.description||"",startDate:r.startDate,endDate:r.endDate,variant:r.variant||"primary",color:r.color||"blue",productData:r.productData,event_type:r.event_type||""});},[r,t]);let p=[{key:"blue",name:"Marrom"},{key:"red",name:"Vermelho"},{key:"green",name:"Verde"},{key:"yellow",name:"Amarelo"}];function y(o){switch(o){case"primary":return "blue";case"danger":return "red";case"success":return "green";case"warning":return "yellow";default:return "blue"}}function N(o){switch(o){case"blue":return "primary";case"red":return "danger";case"green":return "success";case"yellow":return "warning";default:return "default"}}return u.createElement("form",{className:"flex flex-col gap-3 max-h-[80vh] overflow-y-auto pr-2",onSubmit:d(o=>{let T=n?.find(q=>q.product_id===C&&(!M||q.learning_path_title===M)&&q.module_id===P),U={id:r?.id??v4(),title:o.title,startDate:o.startDate,endDate:o.endDate,variant:o.variant,description:o.description||"",event_type:o.event_type,productData:T?{product_id:T.product_id,product_title:T.product_title,learning_path_title:T.learning_path_title,module_id:T.module_id,module_title:T.module_title}:void 0};r?.id?W.handleUpdateEvent(U,r?.id):W.handleAddEvent(U),i();})},e?e({register:l,errors:a}):u.createElement(u.Fragment,null,s?u.createElement(u.Fragment,null):u.createElement(Input,{...l("title"),label:"Nome do Evento",placeholder:"Digite o nome do evento",variant:"flat",isReadOnly:s,isInvalid:!!a.title,errorMessage:a.title?.message}),s?u.createElement("div",{className:"w-full min-h-fit overflow-y-auto p-3 rounded-medium bg-default-100",dangerouslySetInnerHTML:{__html:r?.description||""}}):u.createElement(Textarea,{...l("description"),label:"Descri\xE7\xE3o do Evento",placeholder:"Digite a descri\xE7\xE3o do evento",variant:"flat"}),s?r?.event_type?u.createElement("div",{className:"flex flex-col gap-1"},u.createElement("span",{className:"text-sm text-default-700"},"Tipo do Evento"),u.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},r?.event_type||"")):null:c&&c.length>0?u.createElement(Select,{...l("event_type"),label:"Tipo do Evento",placeholder:"Selecione o tipo do evento",variant:"flat",isInvalid:!!a.event_type,errorMessage:a.event_type?.message},(c||[]).map(o=>u.createElement(SelectItem,{key:o,value:o},o))):null,u.createElement(ee,{data:r,setValue:g,readOnly:s}),S&&S.length>0&&u.createElement("div",{className:"flex flex-col gap-3"},s?C?u.createElement("div",{className:"flex flex-col gap-1"},u.createElement("span",{className:"text-sm text-default-700"},"Conte\xFAdo"),u.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},S?.find(o=>o.id===C)?.title||"")):null:u.createElement(Select,{label:"Conte\xFAdo",placeholder:"Selecione um conte\xFAdo",value:C,variant:"flat",onChange:o=>{b(o.target.value),E(""),A("");}},(S||[]).map(o=>u.createElement(SelectItem,{key:o.id,value:o.id},o.title))),V&&V.length>0&&(s?u.createElement("div",{className:"flex flex-col gap-1"},u.createElement("span",{className:"text-sm text-default-700"},"Trilha"),u.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},M||"")):u.createElement(Select,{label:"Trilha",placeholder:"Selecione uma trilha (opcional)",value:M,variant:"flat",onChange:o=>{E(o.target.value),A("");}},V.map(o=>u.createElement(SelectItem,{key:o,value:o},o)))),H&&H.length>0&&(s?u.createElement("div",{className:"flex flex-col gap-1"},u.createElement("span",{className:"text-sm text-default-700"},"M\xF3dulo"),u.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},H.find(o=>o.id===P)?.title||"")):u.createElement(Select,{label:"M\xF3dulo",placeholder:"Selecione um m\xF3dulo",value:P,variant:"flat",onChange:o=>A(o.target.value)},H.map(o=>u.createElement(SelectItem,{key:o.id,value:o.id},o.title))))),!s&&u.createElement(Dropdown,{backdrop:"blur"},u.createElement(DropdownTrigger,null,u.createElement(Button,{variant:"flat",className:"justify-between w-fit my-4",color:N(h)},p.find(o=>o.key===h)?.name)),u.createElement(DropdownMenu,{"aria-label":"Color selection",variant:"flat",selectionMode:"single",selectedKeys:[h],onSelectionChange:o=>{let T=o.currentKey||"blue";m(T),t(I=>({...I,variant:N(T)}));}},p.map(o=>u.createElement(DropdownItem,{key:o.key,startContent:u.createElement("div",{className:`w-4 h-4 rounded-full bg-${o.key}-500`})},o.name)))),s&&u.createElement(ModalFooter,{className:"px-0"},u.createElement(Button,{color:"primary",variant:"flat",onPress:i},"Fechar")),!s&&u.createElement(ModalFooter,{className:"px-0"},u.createElement(Button,{color:"danger",variant:"light",onPress:i},"Cancelar"),u.createElement(Button,{color:"primary",type:"submit"},"Salvar Evento"))))}var we=e=>e.toLocaleString("pt-BR",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0});function O({event:e,CustomEventModal:n}){let{showModal:c}=F(),{handlers:i}=z();function r(s){c({title:s?.title,body:u.createElement($,{CustomAddEventModal:n?.CustomAddEventModal?.CustomForm,productData:n?.CustomAddEventModal?.ProductData,eventTypes:n?.CustomAddEventModal?.eventTypes}),getter:async()=>({...s})});}let v=s=>s?.replace(/<[^>]*>/g,"");return u.createElement(motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2,ease:"easeInOut"},key:e?.id,className:"w-full relative use-automation-zoom-in cursor-pointer border border-default-400/60 rounded-lg  flex flex-col flex-grow "},e?.canEdit&&u.createElement(Chip,{onClickCapture:s=>{s.stopPropagation(),i.handleDeleteEvent(e?.id);},color:"danger",variant:"solid",classNames:{content:"max-w-fit min-w-0 p-1"},className:"absolute z-50 right-0 top-[-5px]"},u.createElement(TrashIcon,{size:12})),e.CustomEventComponent?u.createElement("div",{onClickCapture:s=>{s.stopPropagation(),r({id:e?.id,title:e?.title,startDate:e?.startDate,endDate:e?.endDate,description:e?.description,variant:e?.variant});}},u.createElement(e.CustomEventComponent,{...e})):u.createElement(Chip,{onClickCapture:s=>{s.stopPropagation(),r({id:e?.id,title:e?.title,startDate:e?.startDate,endDate:e?.endDate,description:e?.description,variant:e?.variant});},variant:"flat",color:e?.variant,classNames:{content:"p-0"},className:`min-w-full items-start p-0 flex-grow flex-col flex ${e?.minmized?"h-full":"min-h-fit p-1"} rounded-md`},u.createElement("div",{className:`flex ${e?.minmized?"p-0":"p-1"} flex-col flex-grow px-1 rounded-md  items-start w-full`},u.createElement("h1",{className:`${e?.minmized&&"text-[0.7rem] p-0 px-1"} font-semibold line-clamp-1 break-all whitespace-pre-wrap`},v(e?.title)),u.createElement("p",{className:"text-[0.65rem] break-all whitespace-pre-wrap line-clamp-3"},v(e?.description||"")),!e?.minmized&&u.createElement("div",{className:"flex justify-between w-full"},u.createElement("p",{className:"text-sm"},we(e?.startDate)),u.createElement("p",{className:"text-sm"},"-"),u.createElement("p",{className:"text-sm"},we(e?.endDate))))))}var ut=Array.from({length:24},(e,n)=>`${n.toString().padStart(2,"0")}:00`),ct={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},pt={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3}}};function ne({prevButton:e,nextButton:n,CustomEventComponent:c,CustomEventModal:i,classNames:r}){let v=useRef(null),[s,h]=useState(null),[m,C]=useState(0),[b,M]=useState(new Date),{showModal:E}=F(),{getters:P,handlers:A}=z(),V=t=>{if(!v.current)return;let a=v.current.getBoundingClientRect(),g=t.clientY-a.top,p=a.height/24,y=Math.max(0,Math.min(23,Math.floor(g/p))),N=g%p/p,k=Math.floor(N*60);h(`${y.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`),C(g);},H=()=>b.toLocaleDateString("pt-BR",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),S=P.getEventsForDay(b?.getDate()||0,b);function Y(t){E({title:i?.CustomAddEventModal?.title||"Adicionar Evento",body:u.createElement($,{CustomAddEventModal:i?.CustomAddEventModal?.CustomForm,productData:i?.CustomAddEventModal?.ProductData,eventTypes:i?.CustomAddEventModal?.eventTypes}),getter:async()=>{let a=t?.startDate||new Date,g=t?.endDate||new Date;return {startDate:a,endDate:g}}});}function W(t){if(!t){console.error("Detailed hour not provided.");return}let[a,g]=t.split(":").map(Number),p=b.getDate();if(p<1||p>31){console.error("Invalid day selected:",p);return}let y=new Date(b.getFullYear(),b.getMonth(),p,a,g);Y({startDate:y,endDate:new Date(y.getTime()+60*60*1e3),title:"",id:"",variant:"primary"});}let l=()=>{let t=new Date(b);t.setDate(b.getDate()+1),M(t);},d=()=>{let t=new Date(b);t.setDate(b.getDate()-1),M(t);};return u.createElement("div",{className:""},u.createElement("div",{className:"flex justify-between gap-3 flex-wrap mb-5"},u.createElement("h1",{className:"text-3xl font-semibold mb-4"},H()),u.createElement("div",{className:"flex ml-auto  gap-3"},e?u.createElement("div",{onClick:d},e):u.createElement(Button,{className:r?.prev,startContent:u.createElement(ArrowLeft,null),onClick:d},"Anterior"),n?u.createElement("div",{onClick:l},n):u.createElement(Button,{className:r?.next,onClick:l,endContent:u.createElement(ArrowRight,null)},"Pr\xF3ximo"))),u.createElement("div",{className:"flex flex-col gap-4"},u.createElement("div",{className:"all-day-events"},u.createElement(AnimatePresence,{mode:"wait"},S&&S?.length?S?.map((t,a)=>u.createElement("div",{key:`event-${t.id}-${a}`,className:"mb-2"},u.createElement(O,{event:{...t,CustomEventComponent:c,minmized:!1},CustomEventModal:i}))):"Nenhum evento para hoje")),u.createElement("div",{className:"relative rounded-md bg-default-50 hover:bg-default-100 transition duration-400"},u.createElement(motion.div,{className:"relative rounded-xl flex ease-in-out",ref:v,variants:ct,initial:"hidden",animate:"visible",onMouseMove:V,onMouseLeave:()=>h(null)},u.createElement("div",{className:"flex  flex-col"},ut.map((t,a)=>u.createElement(motion.div,{key:`hour-${a}`,variants:pt,className:"cursor-pointer   transition duration-300  p-4 h-[64px] text-left text-sm text-muted-foreground border-default-200"},t))),u.createElement("div",{className:"flex relative flex-grow flex-col "},Array.from({length:24}).map((t,a)=>u.createElement("div",{onClick:()=>{W(s);},key:`hour-${a}`,className:"cursor-pointer w-full relative border-b  hover:bg-default-200/50  transition duration-300  p-4 h-[64px] text-left text-sm text-muted-foreground border-default-200"},u.createElement("div",{className:"absolute bg-default-200 flex items-center justify-center text-xs opacity-0 transition left-0 top-0 duration-250 hover:opacity-100 w-full h-full"},"Adicionar Evento"))),u.createElement(AnimatePresence,{mode:"wait"},S&&S?.length?S?.map((t,a)=>{let{height:g,left:p,maxWidth:y,minWidth:N,top:k,zIndex:o}=A.handleEventStyling(t,S);return u.createElement("div",{key:`event-${t.id}-${a}`,style:{minHeight:g,top:k,left:p,maxWidth:y,minWidth:N},className:"flex transition-all duration-1000 flex-grow flex-col z-50 absolute"},u.createElement(O,{event:{...t,CustomEventComponent:c,minmized:!0},CustomEventModal:i}))}):""))),s&&u.createElement("div",{className:"absolute left-[50px] w-[calc(100%-53px)] h-[3px]  bg-primary-300 dark:bg-primary/30 rounded-full pointer-events-none",style:{top:`${m}px`}},u.createElement(Chip,{color:"success",variant:"flat",className:"absolute vertical-abs-center z-50 left-[-55px] text-xs uppercase"},s)))))}function oe(){let{data:e}=F(),n=e?.dayEvents||[];return u.createElement("div",{className:"flex flex-col gap-2"},n.map(c=>u.createElement(O,{key:c.id,event:{...c}})))}function re({prevButton:e,nextButton:n,CustomEventComponent:c,CustomEventModal:i,classNames:r}){let{getters:v,weekStartsOn:s}=z(),{showModal:h}=F(),[m,C]=useState(new Date),b=v.getDaysInMonth(m.getMonth(),m.getFullYear()),M=()=>{let t=new Date(m.getFullYear(),m.getMonth()-1,1);C(t);},E=()=>{let t=new Date(m.getFullYear(),m.getMonth()+1,1);C(t);};function P(t){h({title:"Adicionar Evento",body:u.createElement($,null),getter:async()=>{let a=new Date(m.getFullYear(),m.getMonth(),t??1,0,0,0,0),g=new Date(m.getFullYear(),m.getMonth(),t??1,23,59,59,999);return {startDate:a,endDate:g}}});}function A(t){h({title:t?.[0]?.startDate.toLocaleDateString("pt-BR",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),body:u.createElement(oe,null),getter:async()=>({dayEvents:t})});}let V={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.02}}},H={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3}}},S=s==="monday"?["Seg","Ter","Qua","Qui","Sex","S\xE1b","Dom"]:["Dom","Seg","Ter","Qua","Qui","Sex","S\xE1b"],W=(new Date(m.getFullYear(),m.getMonth(),1).getDay()-(s==="monday"?1:0)+7)%7,l=new Date(m.getFullYear(),m.getMonth()-1,1),d=new Date(l.getFullYear(),l.getMonth()+1,0).getDate();return u.createElement("div",null,u.createElement("div",{className:"flex flex-col mb-4"},u.createElement(motion.h2,{key:m.getMonth(),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},className:"text-lg my-5 tracking-tighter font-bold"},m.toLocaleString("default",{month:"long"})," ",m.getFullYear()),u.createElement("div",{className:"flex gap-3"},e?u.createElement("div",{onClick:M},e):u.createElement(Button,{className:r?.prev,startContent:u.createElement(ArrowLeft,null),onClick:M},"Anterior"),n?u.createElement("div",{onClick:E},n):u.createElement(Button,{className:r?.next,onClick:E,endContent:u.createElement(ArrowRight,null)},"Pr\xF3ximo"))),u.createElement(AnimatePresence,{mode:"wait"},u.createElement(motion.div,{variants:V,initial:"hidden",animate:"visible",key:m.getMonth(),className:"grid grid-cols-7 gap-1 sm:gap-2"},S.map((t,a)=>u.createElement("div",{key:a,className:"text-left my-8 text-2xl tracking-tighter font-medium"},t)),Array.from({length:W}).map((t,a)=>u.createElement("div",{key:`offset-${a}`,className:"h-[150px] opacity-50"},u.createElement("div",{className:ke("font-semibold relative text-lg mb-1")},d-W+a+1))),b.map(t=>{let a=v.getEventsForDay(t.day,m);return u.createElement(motion.div,{className:"hover:z-50 border-none h-[150px] rounded group flex flex-col",key:t.day,variants:H},u.createElement(Card,{isPressable:!0,className:"shadow-md  relative flex p-4 border border-default-100 h-full",onClick:()=>P(t.day)},u.createElement("div",{className:ke("font-semibold relative text-lg mb-1",a.length>0?"text-primary-600":"text-muted-foreground",new Date().getDate()===t.day&&new Date().getMonth()===m.getMonth()&&new Date().getFullYear()===m.getFullYear()?"text-secondary-500":"")},t.day),u.createElement("div",{className:"flex-grow flex flex-col gap-2 w-full overflow-hidden"},u.createElement(AnimatePresence,{mode:"wait"},a?.length>0&&u.createElement(O,{event:{...a[0],CustomEventComponent:c,minmized:!0},CustomEventModal:i})),a.length>1&&u.createElement(Chip,{onClick:g=>{g.stopPropagation(),A(a);},variant:"flat",className:"hover:bg-default-200 absolute right-2 text-xs top-2 transition duration-300"},a.length>1?`+${a.length-1}`:" ")),a.length===0&&u.createElement("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300"},u.createElement("span",{className:"text-white tracking-tighter text-lg font-semibold"},"Adicionar Evento"))))}))))}var Nt=Array.from({length:24},(e,n)=>`${n.toString().padStart(2,"0")}:00`);var St={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}};function se({prevButton:e,nextButton:n,CustomEventComponent:c,CustomEventModal:i,classNames:r}){let{getters:v,handlers:s}=z(),h=useRef(null),[m,C]=useState(null),[b,M]=useState(0),[E,P]=useState(new Date),{showModal:A}=F(),V=v?.getDaysInWeek(v?.getWeekNumber(E),E.getFullYear()),H=d=>{if(!h.current)return;let t=h.current.getBoundingClientRect(),a=d.clientY-t.top,g=t.height/24,p=Math.max(0,Math.min(23,Math.floor(a/g))),y=a%g/g,N=Math.floor(y*60);C(`${p.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`),M(a+83);};function S(d){A({title:"Adicionar Evento",body:u.createElement($,null),getter:async()=>{let t=d?.startDate||new Date,a=d?.endDate||new Date;return {startDate:t,endDate:a}}});}let Y=()=>{let d=new Date(E);d.setDate(E.getDate()+7),P(d);},W=()=>{let d=new Date(E);d.setDate(E.getDate()-7),P(d);};function l(d,t){if(!t){console.error("Detailed hour not provided.");return}let[a,g]=t.split(":").map(Number),p=V[d%7].getDate();if(p<1||p>31){console.error("Invalid day selected:",p);return}let y=new Date(E.getFullYear(),E.getMonth(),p,a,g);S({startDate:y,endDate:new Date(y.getTime()+60*60*1e3),title:"",id:"",variant:"primary"});}return u.createElement("div",{className:"flex flex-col gap-4"},u.createElement(motion.div,{key:E.toDateString()+"parent",className:"all-week-events flex flex-col gap-2",variants:St,initial:"hidden",animate:"visible"}),u.createElement("div",{className:"flex ml-auto gap-3"},e?u.createElement("div",{onClick:W},e):u.createElement(Button,{className:r?.prev,startContent:u.createElement(ArrowLeft,null),onClick:W},"Anterior"),n?u.createElement("div",{onClick:Y},n):u.createElement(Button,{className:r?.next,onClick:Y,endContent:u.createElement(ArrowRight,null)},"Pr\xF3ximo")),u.createElement("div",{key:E.toDateString(),className:"grid use-automation-zoom-in grid-cols-8 gap-0"},u.createElement("div",{className:"sticky top-0 left-0 z-30 bg-default-100 rounded-tl-lg h-full border-0  flex items-center justify-center"},u.createElement("span",{className:"text-lg font-semibold text-muted-foreground px-4"},"Semana ",v.getWeekNumber(E))),u.createElement("div",{className:"col-span-7 flex flex-col relative"},u.createElement("div",{className:"grid grid-cols-7 gap-0 flex-grow"},V.map((d,t)=>u.createElement("div",{key:t,className:"relative flex flex-col"},u.createElement("div",{className:"sticky bg-default-100 top-0 z-20 flex-grow flex items-center justify-center"},u.createElement("div",{className:"text-center p-4"},u.createElement("div",{className:"text-lg font-semibold"},v.getDayName(d.getDay())),u.createElement("div",{className:ke("text-lg font-semibold",new Date().getDate()===d.getDate()&&new Date().getMonth()===E.getMonth()&&new Date().getFullYear()===E.getFullYear()?"text-secondary-500":"")},d.getDate()))),u.createElement("div",{className:"absolute top-12 right-0 w-px h-[calc(100%-3rem)]"})))),m&&u.createElement("div",{className:"absolute flex z-10 left-0 w-full h-[3px] bg-primary-300 dark:bg-primary/30 rounded-full pointer-events-none",style:{top:`${b}px`}},u.createElement(Chip,{color:"success",variant:"flat",className:"absolute vertical-abs-center z-50 left-[-55px] text-xs uppercase"},m))),u.createElement("div",{ref:h,onMouseMove:H,onMouseLeave:()=>C(null),className:"relative grid grid-cols-8 col-span-8"},u.createElement("div",{className:"col-span-1 bg-default-50 hover:bg-default-100 transition duration-400"},Nt.map((d,t)=>u.createElement("div",{key:`hour-${t}`,className:"cursor-pointer border-b border-default-200 p-[16px] h-[64px] text-center text-sm text-muted-foreground border-r"},d))),u.createElement("div",{className:"col-span-7 bg-default-50 grid h-full grid-cols-7"},Array.from({length:7},(d,t)=>{let a=v.getEventsForDay(V[t%7].getDate(),E);return u.createElement("div",{key:`day-${t}`,className:"col-span-1  border-default-200 z-20 relative transition duration-300 cursor-pointer border-r border-b text-center text-sm text-muted-foreground",onClick:()=>{l(t,m);}},u.createElement(AnimatePresence,{mode:"wait"},a?.map((g,p)=>{let{height:y,left:N,maxWidth:k,minWidth:o,top:T,zIndex:I}=s.handleEventStyling(g,a);return u.createElement("div",{key:`event-${g.id}-${p}`,style:{minHeight:y,height:y,top:T,left:N,maxWidth:k,minWidth:o},className:"flex transitio transition-all duration-1000 flex-grow flex-col z-50 absolute"},u.createElement(O,{event:{...g,CustomEventComponent:c,minmized:!0},CustomEventModal:i}))})),Array.from({length:24},(g,p)=>u.createElement("div",{key:`day-${t}-hour-${p}`,className:"col-span-1 border-default-200 h-16 z-20 relative transition duration-300 cursor-pointer border-r border-b text-center text-sm text-muted-foreground"},u.createElement("div",{className:"absolute bg-default-100 flex items-center justify-center text-xs opacity-0 transition duration-250 hover:opacity-100 w-full h-full"},"Adicionar Evento"))))})))))}var me={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,type:"spring",stiffness:250}};function Pe({views:e={views:["day","week","month"],mobileViews:["day"]},CustomComponents:n,classNames:c}){let{showModal:i}=F(),[r,v]=u.useState(!1);useEffect(()=>{v(!0);},[]);let[s,h]=u.useState(r?window.innerWidth<=768:!1);useEffect(()=>{if(!r)return;h(window.innerWidth<=768);function b(){window&&window.innerWidth<=768?h(!0):h(!1);}return window&&window.addEventListener("resize",b),()=>window&&window.removeEventListener("resize",b)},[r]);function m(b){i({title:n?.CustomEventModal?.CustomAddEventModal?.title||"Adicionar Evento",body:u.createElement($,{CustomAddEventModal:n?.CustomEventModal?.CustomAddEventModal?.CustomForm,productData:n?.CustomEventModal?.CustomAddEventModal?.ProductData,eventTypes:n?.CustomEventModal?.CustomAddEventModal?.eventTypes}),getter:async()=>{let M=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate(),0,0,0,0),E=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate(),23,59,59,999);return {startDate:M,endDate:E}}});}let C=s?e?.mobileViews:e?.views;return u.createElement("div",{className:"flex w-full flex-col"},u.createElement("div",{className:"flex w-full"},u.createElement("div",{className:"dayly-weekly-monthly-selection relative w-full"},u.createElement(Tabs,{classNames:{...c?.tabs},"aria-label":"Options",color:"primary",variant:"solid"},C?.includes("day")&&u.createElement(Tab,{key:"day",title:n?.customTabs?.CustomDayTab?n.customTabs.CustomDayTab:u.createElement("div",{className:"flex items-center space-x-2"},u.createElement(CalendarDaysIcon,{size:15}),u.createElement("span",null,"Dia"))},u.createElement(motion.div,{...me},u.createElement(ne,{classNames:c?.buttons,prevButton:n?.customButtons?.CustomPrevButton,nextButton:n?.customButtons?.CustomNextButton,CustomEventComponent:n?.CustomEventComponent,CustomEventModal:n?.CustomEventModal}))),C?.includes("week")&&u.createElement(Tab,{key:"week",title:n?.customTabs?.CustomWeekTab?n.customTabs.CustomWeekTab:u.createElement("div",{className:"flex items-center space-x-2"},u.createElement(BsCalendarWeek,null),u.createElement("span",null,"Semana"))},u.createElement(motion.div,{...me},u.createElement(se,{classNames:c?.buttons,prevButton:n?.customButtons?.CustomPrevButton,nextButton:n?.customButtons?.CustomNextButton,CustomEventComponent:n?.CustomEventComponent,CustomEventModal:n?.CustomEventModal}))),C?.includes("month")&&u.createElement(Tab,{key:"month",title:n?.customTabs?.CustomMonthTab?n.customTabs.CustomMonthTab:u.createElement("div",{className:"flex items-center space-x-2"},u.createElement(BsCalendarMonth,null),u.createElement("span",null,"M\xEAs"))},u.createElement(motion.div,{...me},u.createElement(re,{classNames:c?.buttons,prevButton:n?.customButtons?.CustomPrevButton,nextButton:n?.customButtons?.CustomNextButton,CustomEventComponent:n?.CustomEventComponent,CustomEventModal:n?.CustomEventModal})))),n?.customButtons?.CustomAddEventButton?u.createElement("div",{onClick:()=>m(),className:"absolute top-0 right-0"},n?.customButtons.CustomAddEventButton):u.createElement(Button,{onClick:()=>m(),className:"absolute top-0 right-0 "+c?.buttons?.addEvent,color:"primary",startContent:u.createElement(Calendar,null)},"Adicionar Evento"))))}export{Pe as SchedularView,Ge as SchedulerProvider,ye as eventSchema,z as useScheduler,Jt as variants};