import u,{createContext,useReducer,useEffect,useContext,useState,useRef}from'react';import {useDisclosure,Modal,ModalContent,ModalHeader,ModalBody,ModalFooter}from'@nextui-org/modal';import {motion,AnimatePresence}from'framer-motion';import {Button}from'@nextui-org/button';import {Tabs,Tab}from'@nextui-org/tabs';import {CalendarDaysIcon,Calendar,ArrowLeft,ArrowRight,TrashIcon}from'lucide-react';import {BsCalendarWeek,BsCalendarMonth}from'react-icons/bs';import {Input,Textarea}from'@nextui-org/input';import {Select,SelectItem}from'@nextui-org/select';import {Dropdown,DropdownTrigger,DropdownMenu,DropdownItem}from'@nextui-org/dropdown';import {parseDate,Time}from'@internationalized/date';import {DateRangePicker}from'@nextui-org/date-picker';import {TimeInput}from'@nextui-org/date-input';import {useForm}from'react-hook-form';import {zodResolver}from'@hookform/resolvers/zod';import {z as z$1}from'zod';import {v4}from'uuid';import {Chip}from'@nextui-org/chip';import {Card}from'@nextui-org/card';import ke from'clsx';var ce=createContext(void 0),pe=({children:e})=>{let[o,m]=useState(null),[i,h]=useState(null),{isOpen:t,onOpen:p,onClose:v}=useDisclosure(),l=async({title:S,body:D,footer:k,modalClassName:y,getter:A})=>{if(m({title:S,body:D,footer:k,modalClassName:y}),A)try{let P=await A();h(P);}catch(P){console.error("Error fetching data:",P),h(null);}else h(null);p();};return u.createElement(ce.Provider,{value:{showModal:l,onClose:v,data:i}},e,u.createElement(Modal,{backdrop:"blur",classNames:{backdrop:"max-h-screen overflow-hidden",wrapper:"max-h-screen overflow-hidden"},isOpen:t,onOpenChange:v},u.createElement(ModalContent,{className:o?.modalClassName||""},o&&u.createElement(u.Fragment,null,o.title&&u.createElement(ModalHeader,null,o.title),o.body&&u.createElement(ModalBody,null,o.body),o.footer&&u.createElement(ModalFooter,null,o.footer)))))},B=()=>{let e=useContext(ce);if(!e)throw new Error("useModalContext must be used within a ModalProvider");return e};var Ge=(e,o)=>{switch(o.type){case"ADD_EVENT":return {...e,events:[...e.events,o.payload]};case"REMOVE_EVENT":return {...e,events:e.events.filter(m=>m.id!==o.payload.id)};case"UPDATE_EVENT":return {...e,events:e.events.map(m=>m.id===o.payload.id?o.payload:m)};case"SET_EVENTS":return {...e,events:o.payload};default:return e}},ge=createContext(void 0),qe=({children:e,onAddEvent:o,onUpdateEvent:m,onDeleteEvent:i,initialState:h,weekStartsOn:t="sunday",canEdit:p=v=>!0})=>{let[v,l]=useReducer(Ge,{events:h??[]});useEffect(()=>{h&&l({type:"SET_EVENTS",payload:h});},[h]);let P={getDaysInMonth:(s,d)=>Array.from({length:new Date(d,s+1,0).getDate()},(n,r)=>({day:r+1,events:[]})),getEventsForDay:(s,d)=>v?.events.filter(n=>{let r=new Date(n.startDate),g=new Date(n.endDate),c=new Date(d);c.setDate(s),c.setHours(0,0,0,0);let x=new Date(d);x.setDate(s+1),x.setHours(0,0,0,0);let M=r.getDate()===s&&r.getMonth()===d.getMonth()&&r.getFullYear()===d.getFullYear(),T=r<x&&g>=c;return M||T}),getDaysInWeek:(s,d)=>{let n=t==="sunday"?0:1,r=new Date(d,0,1),g=r.getDay(),c=new Date(r);c.setDate(r.getDate()+(s-1)*7+(n-g+7)%7);let x=[];for(let M=0;M<7;M++){let T=new Date(c);T.setDate(T.getDate()+M),x.push(T);}return x},getWeekNumber:s=>{let d=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate()));d.setUTCDate(d.getUTCDate()+4-(d.getUTCDay()||7));let n=new Date(Date.UTC(d.getUTCFullYear(),0,1));return Math.ceil(((d.getTime()-n.getTime())/864e5+1)/7)},getDayName:s=>["Dom","Seg","Ter","Qua","Qui","Sex","S\xE1b"][s]};function F(s,d){let n=d.filter(T=>T.startDate<s.endDate&&T.endDate>s.startDate),r=n.length||1,g=n.indexOf(s),c=0,x=0,M=0;if(s.startDate instanceof Date&&s.endDate instanceof Date){let T=s.startDate.getHours()*60+s.startDate.getMinutes();c=(s.endDate.getHours()*60+s.endDate.getMinutes()-T)/60*64;let I=s.startDate.getHours()+s.startDate.getMinutes()/60;x=Math.max(0,(24-I)*64),c=Math.min(c,x),M=I*64;}else console.error("Invalid event or missing start/end dates.");return {height:`${c<10?20:c>x?x:c}px`,top:`${M}px`,zIndex:g+1,left:`${g*100/r}%`,maxWidth:`${100/r}%`,minWidth:`${100/r}%`}}function $(s){l({type:"ADD_EVENT",payload:s}),o&&o(s);}function _(s,d){l({type:"UPDATE_EVENT",payload:{...s,id:d}}),m&&m(s);}function H(s){l({type:"REMOVE_EVENT",payload:{id:s}}),i&&i(s);}let W={handleEventStyling:F,handleAddEvent:$,handleUpdateEvent:_,handleDeleteEvent:H};return u.createElement(ge.Provider,{value:{events:v,dispatch:l,getters:P,handlers:W,weekStartsOn:t,canEdit:p}},u.createElement(pe,null,e))},z=()=>{let e=useContext(ge);if(!e)throw new Error("useScheduler must be used within a SchedulerProvider");return e};function K(e){return `${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function he(e){let{year:o,month:m,day:i}=e;return new Date(o,m-1,i)}function ee({data:e,setValue:o,readOnly:m=!1}){let[i,h]=useState({startDate:e?parseDate(K(e?.startDate)):parseDate("2024-04-06"),endDate:e?parseDate(K(e?.endDate)):parseDate("2024-04-10"),startTime:new Time(e?.startDate?.getHours()||0,e?.startDate?.getMinutes()||0),endTime:new Time(e?.endDate?.getHours()||0,e?.endDate?.getMinutes()||0)});return useEffect(()=>{if(!i)return;let t=he(i.startDate),p=he(i.endDate);t.setHours(i?.startTime?.hour||0),t.setMinutes(i?.startTime?.minute||0),p.setHours(i?.endTime?.hour||0),p.setMinutes(i?.endTime?.minute||0),p<t&&p.setHours(t.getHours()+1),o("startDate",t),o("endDate",p);},[i,o]),u.createElement("div",{style:{pointerEvents:m?"none":"auto"}},u.createElement("div",{className:"w-full flex gap-4 max-w-full flex-wrap"},u.createElement(DateRangePicker,{label:"Dura\xE7\xE3o do Evento",isRequired:!0,isReadOnly:m,value:{start:i.startDate,end:i.endDate},className:"w-full",onChange:t=>{let p=t?.start,v=t?.end,l=new Date(p?.year||0,(p?.month||1)-1,p?.day||1),S=new Date(v?.year||0,(v?.month||1)-1,v?.day||1);h({...i,startDate:parseDate(K(l)),endDate:parseDate(K(S))});}}),u.createElement("div",{className:"flex flex-wrap gap-4 flex-row flex-grow"},u.createElement(TimeInput,{label:"Hora de In\xEDcio",defaultValue:i?.startTime,isReadOnly:m,className:"flex-1",onChange:t=>{h({...i,startTime:t||new Time(0,0)});}}),u.createElement(TimeInput,{label:"Hora de T\xE9rmino",defaultValue:i?.endTime,isReadOnly:m,className:"flex-1",onChange:t=>{h({...i,endTime:t||new Time(0,0)});},isInvalid:i?.startTime&&i?.endTime&&i.endTime.hour*60+i.endTime.minute<=i.startTime.hour*60+i.startTime.minute}))))}var Jt=["success","primary","default","warning","danger"],ye=z$1.object({id:z$1.string().optional(),title:z$1.string().nonempty("Event name is required"),description:z$1.string().optional(),startDate:z$1.date(),endDate:z$1.date(),variant:z$1.enum(["primary","danger","success","warning","default"]),color:z$1.string().nonempty("Color selection is required"),event_type:z$1.string().optional(),productData:z$1.object({product_id:z$1.string().nonempty("Product ID is required"),product_title:z$1.string().nonempty("Product title is required"),learning_path_title:z$1.string().optional(),module_id:z$1.string().nonempty("Module ID is required"),module_title:z$1.string().nonempty("Module title is required")}).optional(),selectedProduct:z$1.object({product_id:z$1.string().nonempty("Product ID is required"),learning_path_id:z$1.string().optional(),module_id:z$1.string().optional()}).optional()});function O({CustomAddEventModal:e,productData:o,eventTypes:m,selectedProduct:i}){let{onClose:h,data:t}=B(),{canEdit:p}=z(),v=!!t?.id&&!p(t?.id||""),[l,S]=useState(x(t?.variant||"primary")),[D,k]=useState(i?.id||t?.selectedProduct?.product_id||""),[y,A]=useState(i?.learning_path_id||t?.selectedProduct?.learning_path_id||""),[P,F]=useState(i?.module_id||t?.selectedProduct?.module_id||"");useEffect(()=>{i?(k(i.id||""),A(i.learning_path_id||""),F(i.module_id||"")):t?.selectedProduct&&(k(t.selectedProduct.product_id||""),A(t.selectedProduct.learning_path_id||""),F(t.selectedProduct.module_id||""));},[i,t?.selectedProduct]);let $=o?.filter(a=>a.product_id===D).map(a=>a.learning_path_title).filter((a,C,I)=>a&&I.indexOf(a)===C),_=o?.filter(a=>a.product_id===D&&(!y||a.learning_path_title===y)).map(a=>({id:a.module_id,title:a.module_title})).filter((a,C,I)=>I.findIndex(U=>U.id===a.id)===C),H=o?.map(a=>({id:a.product_id,title:a.product_title})).filter((a,C,I)=>I.findIndex(U=>U.id===a.id)===C),{handlers:W}=z(),{register:s,handleSubmit:d,reset:n,formState:{errors:r},setValue:g}=useForm({resolver:zodResolver(ye),defaultValues:{id:t?.id??v4(),title:t?.title??"",description:t?.description??"",startDate:t?.startDate??new Date,endDate:t?.endDate??(()=>{let a=new Date;return a.setHours(a.getHours()+1),a})(),variant:t?.variant??"primary",color:t?.color??"blue",productData:t?.productData,event_type:t?.event_type??"",selectedProduct:{product_id:t?.selectedProduct?.product_id??"",learning_path_id:t?.selectedProduct?.learning_path_id??"",module_id:t?.selectedProduct?.module_id??""}}});useEffect(()=>{t&&n({id:t.id,title:t.title,description:t.description||"",startDate:t.startDate,endDate:t.endDate,variant:t.variant||"primary",color:t.color||"blue",productData:t.productData,event_type:t.event_type||"",selectedProduct:{product_id:t?.selectedProduct?.product_id??"",learning_path_id:t?.selectedProduct?.learning_path_id??"",module_id:t?.selectedProduct?.module_id??""}});},[t,n]);let c=[{key:"blue",name:"Marrom"},{key:"red",name:"Vermelho"},{key:"green",name:"Verde"},{key:"yellow",name:"Amarelo"}];function x(a){switch(a){case"primary":return "blue";case"danger":return "red";case"success":return "green";case"warning":return "yellow";default:return "blue"}}function M(a){switch(a){case"blue":return "primary";case"red":return "danger";case"green":return "success";case"yellow":return "warning";default:return "default"}}return u.createElement("form",{className:"flex flex-col gap-3 max-h-[80vh] overflow-y-auto pr-2",onSubmit:d(a=>{let C=o?.find(q=>q.product_id===D&&(!y||q.learning_path_title===y)&&q.module_id===P),U={id:t?.id??v4(),title:a.title,startDate:a.startDate,endDate:a.endDate,variant:a.variant,description:a.description||"",event_type:a.event_type,productData:C?{id:C.product_id,title:C.product_title,product_id:C.product_id,product_title:C.product_title,learning_path_title:C.learning_path_title,module_id:C.module_id,module_title:C.module_title}:void 0};t?.id?W.handleUpdateEvent(U,t?.id):W.handleAddEvent(U),h();})},e?e({register:s,errors:r}):u.createElement(u.Fragment,null,v?u.createElement(u.Fragment,null):u.createElement(Input,{...s("title"),label:"Nome do Evento",placeholder:"Digite o nome do evento",variant:"flat",isReadOnly:v,isInvalid:!!r.title,errorMessage:r.title?.message}),v?u.createElement("div",{className:"w-full min-h-fit overflow-y-auto p-3 rounded-medium bg-default-100",dangerouslySetInnerHTML:{__html:t?.description||""}}):u.createElement(Textarea,{...s("description"),label:"Descri\xE7\xE3o do Evento",placeholder:"Digite a descri\xE7\xE3o do evento",variant:"flat"}),v?t?.event_type?u.createElement("div",{className:"flex flex-col gap-1"},u.createElement("span",{className:"text-sm text-default-700"},"Tipo do Evento"),u.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},t?.event_type||"")):null:m&&m.length>0?u.createElement(Select,{...s("event_type"),label:"Tipo do Evento",placeholder:"Selecione o tipo do evento",variant:"flat",isInvalid:!!r.event_type,errorMessage:r.event_type?.message},(m||[]).map(a=>u.createElement(SelectItem,{key:a,value:a},a))):null,u.createElement(ee,{data:t,setValue:g,readOnly:v}),H&&H.length>0&&u.createElement("div",{className:"flex flex-col gap-3"},v?D?u.createElement("div",{className:"flex flex-col gap-1"},u.createElement("span",{className:"text-sm text-default-700"},"Conte\xFAdo"),u.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},H?.find(a=>a.id===D)?.title||"")):null:u.createElement(Select,{label:"Conte\xFAdo",placeholder:"Selecione um conte\xFAdo",value:D,variant:"flat",onChange:a=>{k(a.target.value),A(""),F("");}},(H||[]).map(a=>u.createElement(SelectItem,{key:a.id,value:a.id},a.title))),$&&$.length>0&&(v?u.createElement("div",{className:"flex flex-col gap-1"},u.createElement("span",{className:"text-sm text-default-700"},"Trilha"),u.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},y||"")):u.createElement(Select,{label:"Trilha",placeholder:"Selecione uma trilha (opcional)",value:y,variant:"flat",onChange:a=>{A(a.target.value),F("");}},$.map(a=>u.createElement(SelectItem,{key:a,value:a},a)))),_&&_.length>0&&(v?u.createElement("div",{className:"flex flex-col gap-1"},u.createElement("span",{className:"text-sm text-default-700"},"M\xF3dulo"),u.createElement("div",{className:"w-full p-3 rounded-medium bg-default-100"},_.find(a=>a.id===P)?.title||"")):u.createElement(Select,{label:"M\xF3dulo",placeholder:"Selecione um m\xF3dulo",value:P,variant:"flat",onChange:a=>F(a.target.value)},_.map(a=>u.createElement(SelectItem,{key:a.id,value:a.id},a.title))))),!v&&u.createElement(Dropdown,{backdrop:"blur"},u.createElement(DropdownTrigger,null,u.createElement(Button,{variant:"flat",className:"justify-between w-fit my-4",color:M(l)},c.find(a=>a.key===l)?.name)),u.createElement(DropdownMenu,{"aria-label":"Color selection",variant:"flat",selectionMode:"single",selectedKeys:[l],onSelectionChange:a=>{let C=a.currentKey||"blue";S(C),n(I=>({...I,variant:M(C)}));}},c.map(a=>u.createElement(DropdownItem,{key:a.key,startContent:u.createElement("div",{className:`w-4 h-4 rounded-full bg-${a.key}-500`})},a.name)))),v&&u.createElement(ModalFooter,{className:"px-0"},u.createElement(Button,{color:"primary",variant:"flat",onPress:h},"Fechar")),!v&&u.createElement(ModalFooter,{className:"px-0"},u.createElement(Button,{color:"danger",variant:"light",onPress:h},"Cancelar"),u.createElement(Button,{color:"primary",type:"submit"},"Salvar Evento"))))}var be=e=>e.toLocaleString("pt-BR",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0});function Y({event:e,CustomEventModal:o}){let{showModal:m}=B(),{handlers:i}=z();function h(p){m({title:p?.title,body:u.createElement(O,{CustomAddEventModal:o?.CustomAddEventModal?.CustomForm,productData:o?.CustomAddEventModal?.ProductData,eventTypes:o?.CustomAddEventModal?.eventTypes}),getter:async()=>({...p})});}let t=p=>p?.replace(/<[^>]*>/g,"");return u.createElement(motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2,ease:"easeInOut"},key:e?.id,className:"w-full relative use-automation-zoom-in cursor-pointer border border-default-400/60 rounded-lg  flex flex-col flex-grow "},e?.canEdit&&u.createElement(Chip,{onClickCapture:p=>{p.stopPropagation(),i.handleDeleteEvent(e?.id);},color:"danger",variant:"solid",classNames:{content:"max-w-fit min-w-0 p-1"},className:"absolute z-50 right-0 top-[-5px]"},u.createElement(TrashIcon,{size:12})),e.CustomEventComponent?u.createElement("div",{onClickCapture:p=>{p.stopPropagation(),h({id:e?.id,title:e?.title,startDate:e?.startDate,endDate:e?.endDate,description:e?.description,variant:e?.variant});}},u.createElement(e.CustomEventComponent,{...e})):u.createElement(Chip,{onClickCapture:p=>{p.stopPropagation(),h({id:e?.id,title:e?.title,startDate:e?.startDate,endDate:e?.endDate,description:e?.description,variant:e?.variant});},variant:"flat",color:e?.variant,classNames:{content:"p-0"},className:`min-w-full items-start p-0 flex-grow flex-col flex ${e?.minmized?"h-full":"min-h-fit p-1"} rounded-md`},u.createElement("div",{className:`flex ${e?.minmized?"p-0":"p-1"} flex-col flex-grow px-1 rounded-md  items-start w-full`},u.createElement("h1",{className:`${e?.minmized&&"text-[0.7rem] p-0 px-1"} font-semibold line-clamp-1 break-all whitespace-pre-wrap`},t(e?.title)),u.createElement("p",{className:"text-[0.65rem] break-all whitespace-pre-wrap line-clamp-3"},t(e?.description||"")),!e?.minmized&&u.createElement("div",{className:"flex justify-between w-full"},u.createElement("p",{className:"text-sm"},be(e?.startDate)),u.createElement("p",{className:"text-sm"},"-"),u.createElement("p",{className:"text-sm"},be(e?.endDate))))))}var mt=Array.from({length:24},(e,o)=>`${o.toString().padStart(2,"0")}:00`),ct={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},pt={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3}}};function ne({prevButton:e,nextButton:o,CustomEventComponent:m,CustomEventModal:i,classNames:h}){let t=useRef(null),[p,v]=useState(null),[l,S]=useState(0),[D,k]=useState(new Date),{showModal:y}=B(),{getters:A,handlers:P}=z(),F=n=>{if(!t.current)return;let r=t.current.getBoundingClientRect(),g=n.clientY-r.top,c=r.height/24,x=Math.max(0,Math.min(23,Math.floor(g/c))),M=g%c/c,T=Math.floor(M*60);v(`${x.toString().padStart(2,"0")}:${T.toString().padStart(2,"0")}`),S(g);},$=()=>D.toLocaleDateString("pt-BR",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),_=A.getEventsForDay(D?.getDate()||0,D);function H(n){y({title:i?.CustomAddEventModal?.title||"Adicionar Evento",body:u.createElement(O,{CustomAddEventModal:i?.CustomAddEventModal?.CustomForm,productData:i?.CustomAddEventModal?.ProductData,eventTypes:i?.CustomAddEventModal?.eventTypes}),getter:async()=>{let r=n?.startDate||new Date,g=n?.endDate||new Date;return {startDate:r,endDate:g}}});}function W(n){if(!n){console.error("Detailed hour not provided.");return}let[r,g]=n.split(":").map(Number),c=D.getDate();if(c<1||c>31){console.error("Invalid day selected:",c);return}let x=new Date(D.getFullYear(),D.getMonth(),c,r,g);H({startDate:x,endDate:new Date(x.getTime()+60*60*1e3),title:"",id:"",variant:"primary"});}let s=()=>{let n=new Date(D);n.setDate(D.getDate()+1),k(n);},d=()=>{let n=new Date(D);n.setDate(D.getDate()-1),k(n);};return u.createElement("div",{className:""},u.createElement("div",{className:"flex justify-between gap-3 flex-wrap mb-5"},u.createElement("h1",{className:"text-3xl font-semibold mb-4"},$()),u.createElement("div",{className:"flex ml-auto  gap-3"},e?u.createElement("div",{onClick:d},e):u.createElement(Button,{className:h?.prev,startContent:u.createElement(ArrowLeft,null),onClick:d},"Anterior"),o?u.createElement("div",{onClick:s},o):u.createElement(Button,{className:h?.next,onClick:s,endContent:u.createElement(ArrowRight,null)},"Pr\xF3ximo"))),u.createElement("div",{className:"flex flex-col gap-4"},u.createElement("div",{className:"all-day-events"},u.createElement(AnimatePresence,{mode:"wait"},_&&_?.length?_?.map((n,r)=>u.createElement("div",{key:`event-${n.id}-${r}`,className:"mb-2"},u.createElement(Y,{event:{...n,CustomEventComponent:m,minmized:!1},CustomEventModal:i}))):"Nenhum evento para hoje")),u.createElement("div",{className:"relative rounded-md bg-default-50 hover:bg-default-100 transition duration-400"},u.createElement(motion.div,{className:"relative rounded-xl flex ease-in-out",ref:t,variants:ct,initial:"hidden",animate:"visible",onMouseMove:F,onMouseLeave:()=>v(null)},u.createElement("div",{className:"flex  flex-col"},mt.map((n,r)=>u.createElement(motion.div,{key:`hour-${r}`,variants:pt,className:"cursor-pointer   transition duration-300  p-4 h-[64px] text-left text-sm text-muted-foreground border-default-200"},n))),u.createElement("div",{className:"flex relative flex-grow flex-col "},Array.from({length:24}).map((n,r)=>u.createElement("div",{onClick:()=>{W(p);},key:`hour-${r}`,className:"cursor-pointer w-full relative border-b  hover:bg-default-200/50  transition duration-300  p-4 h-[64px] text-left text-sm text-muted-foreground border-default-200"},u.createElement("div",{className:"absolute bg-default-200 flex items-center justify-center text-xs opacity-0 transition left-0 top-0 duration-250 hover:opacity-100 w-full h-full"},"Adicionar Evento"))),u.createElement(AnimatePresence,{mode:"wait"},_&&_?.length?_?.map((n,r)=>{let{height:g,left:c,maxWidth:x,minWidth:M,top:T,zIndex:a}=P.handleEventStyling(n,_);return u.createElement("div",{key:`event-${n.id}-${r}`,style:{minHeight:g,top:T,left:c,maxWidth:x,minWidth:M},className:"flex transition-all duration-1000 flex-grow flex-col z-50 absolute"},u.createElement(Y,{event:{...n,CustomEventComponent:m,minmized:!0},CustomEventModal:i}))}):""))),p&&u.createElement("div",{className:"absolute left-[50px] w-[calc(100%-53px)] h-[3px]  bg-primary-300 dark:bg-primary/30 rounded-full pointer-events-none",style:{top:`${l}px`}},u.createElement(Chip,{color:"success",variant:"flat",className:"absolute vertical-abs-center z-50 left-[-55px] text-xs uppercase"},p)))))}function oe(){let{data:e}=B(),o=e?.dayEvents||[];return u.createElement("div",{className:"flex flex-col gap-2"},o.map(m=>u.createElement(Y,{key:m.id,event:{...m}})))}function re({prevButton:e,nextButton:o,CustomEventComponent:m,CustomEventModal:i,classNames:h}){let{getters:t,weekStartsOn:p}=z(),{showModal:v}=B(),[l,S]=useState(new Date),D=t.getDaysInMonth(l.getMonth(),l.getFullYear()),k=()=>{let n=new Date(l.getFullYear(),l.getMonth()-1,1);S(n);},y=()=>{let n=new Date(l.getFullYear(),l.getMonth()+1,1);S(n);};function A(n){v({title:"Adicionar Evento",body:u.createElement(O,null),getter:async()=>{let r=new Date(l.getFullYear(),l.getMonth(),n??1,0,0,0,0),g=new Date(l.getFullYear(),l.getMonth(),n??1,23,59,59,999);return {startDate:r,endDate:g}}});}function P(n){v({title:n?.[0]?.startDate.toLocaleDateString("pt-BR",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),body:u.createElement(oe,null),getter:async()=>({dayEvents:n})});}let F={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.02}}},$={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3}}},_=p==="monday"?["Seg","Ter","Qua","Qui","Sex","S\xE1b","Dom"]:["Dom","Seg","Ter","Qua","Qui","Sex","S\xE1b"],W=(new Date(l.getFullYear(),l.getMonth(),1).getDay()-(p==="monday"?1:0)+7)%7,s=new Date(l.getFullYear(),l.getMonth()-1,1),d=new Date(s.getFullYear(),s.getMonth()+1,0).getDate();return u.createElement("div",null,u.createElement("div",{className:"flex flex-col mb-4"},u.createElement(motion.h2,{key:l.getMonth(),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},className:"text-lg my-5 tracking-tighter font-bold"},l.toLocaleString("default",{month:"long"})," ",l.getFullYear()),u.createElement("div",{className:"flex gap-3"},e?u.createElement("div",{onClick:k},e):u.createElement(Button,{className:h?.prev,startContent:u.createElement(ArrowLeft,null),onClick:k},"Anterior"),o?u.createElement("div",{onClick:y},o):u.createElement(Button,{className:h?.next,onClick:y,endContent:u.createElement(ArrowRight,null)},"Pr\xF3ximo"))),u.createElement(AnimatePresence,{mode:"wait"},u.createElement(motion.div,{variants:F,initial:"hidden",animate:"visible",key:l.getMonth(),className:"grid grid-cols-7 gap-1 sm:gap-2"},_.map((n,r)=>u.createElement("div",{key:r,className:"text-left my-8 text-2xl tracking-tighter font-medium"},n)),Array.from({length:W}).map((n,r)=>u.createElement("div",{key:`offset-${r}`,className:"h-[150px] opacity-50"},u.createElement("div",{className:ke("font-semibold relative text-lg mb-1")},d-W+r+1))),D.map(n=>{let r=t.getEventsForDay(n.day,l);return u.createElement(motion.div,{className:"hover:z-50 border-none h-[150px] rounded group flex flex-col",key:n.day,variants:$},u.createElement(Card,{isPressable:!0,className:"shadow-md  relative flex p-4 border border-default-100 h-full",onClick:()=>A(n.day)},u.createElement("div",{className:ke("font-semibold relative text-lg mb-1",r.length>0?"text-primary-600":"text-muted-foreground",new Date().getDate()===n.day&&new Date().getMonth()===l.getMonth()&&new Date().getFullYear()===l.getFullYear()?"text-secondary-500":"")},n.day),u.createElement("div",{className:"flex-grow flex flex-col gap-2 w-full overflow-hidden"},u.createElement(AnimatePresence,{mode:"wait"},r?.length>0&&u.createElement(Y,{event:{...r[0],CustomEventComponent:m,minmized:!0},CustomEventModal:i})),r.length>1&&u.createElement(Chip,{onClick:g=>{g.stopPropagation(),P(r);},variant:"flat",className:"hover:bg-default-200 absolute right-2 text-xs top-2 transition duration-300"},r.length>1?`+${r.length-1}`:" ")),r.length===0&&u.createElement("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300"},u.createElement("span",{className:"text-white tracking-tighter text-lg font-semibold"},"Adicionar Evento"))))}))))}var Nt=Array.from({length:24},(e,o)=>`${o.toString().padStart(2,"0")}:00`);var St={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}};function se({prevButton:e,nextButton:o,CustomEventComponent:m,CustomEventModal:i,classNames:h}){let{getters:t,handlers:p}=z(),v=useRef(null),[l,S]=useState(null),[D,k]=useState(0),[y,A]=useState(new Date),{showModal:P}=B(),F=t?.getDaysInWeek(t?.getWeekNumber(y),y.getFullYear()),$=d=>{if(!v.current)return;let n=v.current.getBoundingClientRect(),r=d.clientY-n.top,g=n.height/24,c=Math.max(0,Math.min(23,Math.floor(r/g))),x=r%g/g,M=Math.floor(x*60);S(`${c.toString().padStart(2,"0")}:${M.toString().padStart(2,"0")}`),k(r+83);};function _(d){P({title:"Adicionar Evento",body:u.createElement(O,null),getter:async()=>{let n=d?.startDate||new Date,r=d?.endDate||new Date;return {startDate:n,endDate:r}}});}let H=()=>{let d=new Date(y);d.setDate(y.getDate()+7),A(d);},W=()=>{let d=new Date(y);d.setDate(y.getDate()-7),A(d);};function s(d,n){if(!n){console.error("Detailed hour not provided.");return}let[r,g]=n.split(":").map(Number),c=F[d%7].getDate();if(c<1||c>31){console.error("Invalid day selected:",c);return}let x=new Date(y.getFullYear(),y.getMonth(),c,r,g);_({startDate:x,endDate:new Date(x.getTime()+60*60*1e3),title:"",id:"",variant:"primary"});}return u.createElement("div",{className:"flex flex-col gap-4"},u.createElement(motion.div,{key:y.toDateString()+"parent",className:"all-week-events flex flex-col gap-2",variants:St,initial:"hidden",animate:"visible"}),u.createElement("div",{className:"flex ml-auto gap-3"},e?u.createElement("div",{onClick:W},e):u.createElement(Button,{className:h?.prev,startContent:u.createElement(ArrowLeft,null),onClick:W},"Anterior"),o?u.createElement("div",{onClick:H},o):u.createElement(Button,{className:h?.next,onClick:H,endContent:u.createElement(ArrowRight,null)},"Pr\xF3ximo")),u.createElement("div",{key:y.toDateString(),className:"grid use-automation-zoom-in grid-cols-8 gap-0"},u.createElement("div",{className:"sticky top-0 left-0 z-30 bg-default-100 rounded-tl-lg h-full border-0  flex items-center justify-center"},u.createElement("span",{className:"text-lg font-semibold text-muted-foreground px-4"},"Semana ",t.getWeekNumber(y))),u.createElement("div",{className:"col-span-7 flex flex-col relative"},u.createElement("div",{className:"grid grid-cols-7 gap-0 flex-grow"},F.map((d,n)=>u.createElement("div",{key:n,className:"relative flex flex-col"},u.createElement("div",{className:"sticky bg-default-100 top-0 z-20 flex-grow flex items-center justify-center"},u.createElement("div",{className:"text-center p-4"},u.createElement("div",{className:"text-lg font-semibold"},t.getDayName(d.getDay())),u.createElement("div",{className:ke("text-lg font-semibold",new Date().getDate()===d.getDate()&&new Date().getMonth()===y.getMonth()&&new Date().getFullYear()===y.getFullYear()?"text-secondary-500":"")},d.getDate()))),u.createElement("div",{className:"absolute top-12 right-0 w-px h-[calc(100%-3rem)]"})))),l&&u.createElement("div",{className:"absolute flex z-10 left-0 w-full h-[3px] bg-primary-300 dark:bg-primary/30 rounded-full pointer-events-none",style:{top:`${D}px`}},u.createElement(Chip,{color:"success",variant:"flat",className:"absolute vertical-abs-center z-50 left-[-55px] text-xs uppercase"},l))),u.createElement("div",{ref:v,onMouseMove:$,onMouseLeave:()=>S(null),className:"relative grid grid-cols-8 col-span-8"},u.createElement("div",{className:"col-span-1 bg-default-50 hover:bg-default-100 transition duration-400"},Nt.map((d,n)=>u.createElement("div",{key:`hour-${n}`,className:"cursor-pointer border-b border-default-200 p-[16px] h-[64px] text-center text-sm text-muted-foreground border-r"},d))),u.createElement("div",{className:"col-span-7 bg-default-50 grid h-full grid-cols-7"},Array.from({length:7},(d,n)=>{let r=t.getEventsForDay(F[n%7].getDate(),y);return u.createElement("div",{key:`day-${n}`,className:"col-span-1  border-default-200 z-20 relative transition duration-300 cursor-pointer border-r border-b text-center text-sm text-muted-foreground",onClick:()=>{s(n,l);}},u.createElement(AnimatePresence,{mode:"wait"},r?.map((g,c)=>{let{height:x,left:M,maxWidth:T,minWidth:a,top:C,zIndex:I}=p.handleEventStyling(g,r);return u.createElement("div",{key:`event-${g.id}-${c}`,style:{minHeight:x,height:x,top:C,left:M,maxWidth:T,minWidth:a},className:"flex transitio transition-all duration-1000 flex-grow flex-col z-50 absolute"},u.createElement(Y,{event:{...g,CustomEventComponent:m,minmized:!0},CustomEventModal:i}))})),Array.from({length:24},(g,c)=>u.createElement("div",{key:`day-${n}-hour-${c}`,className:"col-span-1 border-default-200 h-16 z-20 relative transition duration-300 cursor-pointer border-r border-b text-center text-sm text-muted-foreground"},u.createElement("div",{className:"absolute bg-default-100 flex items-center justify-center text-xs opacity-0 transition duration-250 hover:opacity-100 w-full h-full"},"Adicionar Evento"))))})))))}var ue={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,type:"spring",stiffness:250}};function Fe({views:e={views:["day","week","month"],mobileViews:["day"]},CustomComponents:o,classNames:m}){let{showModal:i}=B(),[h,t]=u.useState(!1);useEffect(()=>{t(!0);},[]);let[p,v]=u.useState(h?window.innerWidth<=768:!1);useEffect(()=>{if(!h)return;v(window.innerWidth<=768);function D(){window&&window.innerWidth<=768?v(!0):v(!1);}return window&&window.addEventListener("resize",D),()=>window&&window.removeEventListener("resize",D)},[h]);function l(D){i({title:o?.CustomEventModal?.CustomAddEventModal?.title||"Adicionar Evento",body:u.createElement(O,{CustomAddEventModal:o?.CustomEventModal?.CustomAddEventModal?.CustomForm,productData:o?.CustomEventModal?.CustomAddEventModal?.ProductData,eventTypes:o?.CustomEventModal?.CustomAddEventModal?.eventTypes}),getter:async()=>{let k=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate(),0,0,0,0),y=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate(),23,59,59,999);return {startDate:k,endDate:y}}});}let S=p?e?.mobileViews:e?.views;return u.createElement("div",{className:"flex w-full flex-col"},u.createElement("div",{className:"flex w-full"},u.createElement("div",{className:"dayly-weekly-monthly-selection relative w-full"},u.createElement(Tabs,{classNames:{...m?.tabs},"aria-label":"Options",color:"primary",variant:"solid"},S?.includes("day")&&u.createElement(Tab,{key:"day",title:o?.customTabs?.CustomDayTab?o.customTabs.CustomDayTab:u.createElement("div",{className:"flex items-center space-x-2"},u.createElement(CalendarDaysIcon,{size:15}),u.createElement("span",null,"Dia"))},u.createElement(motion.div,{...ue},u.createElement(ne,{classNames:m?.buttons,prevButton:o?.customButtons?.CustomPrevButton,nextButton:o?.customButtons?.CustomNextButton,CustomEventComponent:o?.CustomEventComponent,CustomEventModal:o?.CustomEventModal}))),S?.includes("week")&&u.createElement(Tab,{key:"week",title:o?.customTabs?.CustomWeekTab?o.customTabs.CustomWeekTab:u.createElement("div",{className:"flex items-center space-x-2"},u.createElement(BsCalendarWeek,null),u.createElement("span",null,"Semana"))},u.createElement(motion.div,{...ue},u.createElement(se,{classNames:m?.buttons,prevButton:o?.customButtons?.CustomPrevButton,nextButton:o?.customButtons?.CustomNextButton,CustomEventComponent:o?.CustomEventComponent,CustomEventModal:o?.CustomEventModal}))),S?.includes("month")&&u.createElement(Tab,{key:"month",title:o?.customTabs?.CustomMonthTab?o.customTabs.CustomMonthTab:u.createElement("div",{className:"flex items-center space-x-2"},u.createElement(BsCalendarMonth,null),u.createElement("span",null,"M\xEAs"))},u.createElement(motion.div,{...ue},u.createElement(re,{classNames:m?.buttons,prevButton:o?.customButtons?.CustomPrevButton,nextButton:o?.customButtons?.CustomNextButton,CustomEventComponent:o?.CustomEventComponent,CustomEventModal:o?.CustomEventModal})))),o?.customButtons?.CustomAddEventButton?u.createElement("div",{onClick:()=>l(),className:"absolute top-0 right-0"},o?.customButtons.CustomAddEventButton):u.createElement(Button,{onClick:()=>l(),className:"absolute top-0 right-0 "+m?.buttons?.addEvent,color:"primary",startContent:u.createElement(Calendar,null)},"Adicionar Evento"))))}export{Fe as SchedularView,qe as SchedulerProvider,ye as eventSchema,z as useScheduler,Jt as variants};